# 第五轮调优执行指南 - 防休眠版

## 🎯 快速开始（推荐）

### 方法1：使用自动脚本（最简单）✅

```bash
cd /Users/Jason/Desktop/code/AI/parameter
./run_tuning.sh
```

**优点**：
- ✅ 自动防止Mac休眠
- ✅ 显示开始/结束时间
- ✅ 一键启动，无需额外配置

---

## 🔋 防休眠方法详解

### 方法2：手动使用caffeinate

```bash
cd /Users/Jason/Desktop/code/AI/parameter
caffeinate -i python3 parameter_tuning.py
```

**参数说明**：
- `-i`：防止系统在空闲时休眠（即使盖上笔记本盖子）
- `-d`：防止显示器休眠（可选，费电）
- `-s`：防止系统在接AC电源时休眠（可选）

**组合使用**（最强保护）：
```bash
caffeinate -ids python3 parameter_tuning.py
```

---

### 方法3：系统设置（临时调整）

**步骤**：
1. 打开"系统偏好设置" → "节能"
2. 将"电脑进入睡眠状态前的等待时间"设为"永不"
3. 取消勾选"当显示器关闭时，防止电脑自动进入睡眠"

**⚠️ 注意**：运行完成后记得改回原设置！

---

### 方法4：使用nohup（后台运行）

如果想关闭终端窗口也能继续运行：

```bash
cd /Users/Jason/Desktop/code/AI/parameter
nohup caffeinate -i python3 parameter_tuning.py > tuning_output.log 2>&1 &
```

**查看进度**：
```bash
# 实时监控日志
tail -f tuning_output.log

# 或查看parameter_tuning.txt
tail -f parameter_tuning.txt
```

**查看进程**：
```bash
ps aux | grep parameter_tuning
```

**终止进程**（如需要）：
```bash
pkill -f parameter_tuning.py
```

---

## ⏱️ 运行时间预估

| 阶段 | 配置数 | 预计耗时 |
|------|--------|---------|
| 配置1-3 (基线恢复) | 3 | 36分钟 |
| 配置4-6 (容量调整) | 3 | 36分钟 |
| 配置7-9 (联合优化) | 3 | 45分钟 |
| 配置10-12 (极致优化) | 3 | 45分钟 |
| **总计** | **12** | **~162分钟 (2.7小时)** |

**建议缓冲时间**: +20分钟  
**预留总时长**: **3小时**

---

## 📊 实时监控

### 监控脚本进度

**方法1：查看输出日志**
```bash
tail -f /Users/Jason/Desktop/code/AI/parameter/parameter_tuning.txt
```

**方法2：使用watch命令**
```bash
watch -n 30 'tail -20 /Users/Jason/Desktop/code/AI/parameter/parameter_tuning.txt'
```
每30秒刷新一次最后20行

---

## 🛡️ 防中断检查清单

运行前确认：
- [ ] 笔记本已连接电源
- [ ] 电池电量 > 50%（预防断电）
- [ ] 网络稳定（如需下载依赖）
- [ ] 硬盘空间 > 5GB
- [ ] 已使用caffeinate或关闭自动休眠
- [ ] 终端窗口不会意外关闭

---

## 🚨 异常处理

### 如果训练中断

1. **检查日志**：
```bash
tail -50 parameter_tuning.txt
```

2. **查找最后完成的配置**：
日志会显示"测试配置 X/12"，记录已完成的编号

3. **恢复策略**：
- 如果中断于配置5：已完成1-4，可从配置6继续
- 修改代码跳过已完成配置，或重新运行（耗时更长）

---

## 💡 推荐执行流程

### 最佳实践：

```bash
# 1. 进入目录
cd /Users/Jason/Desktop/code/AI/parameter

# 2. 执行前检查
python3 -c "import tensorflow as tf; print('TensorFlow版本:', tf.__version__)"

# 3. 启动优化（防休眠）
./run_tuning.sh

# 4. 另开一个终端监控进度
tail -f parameter_tuning.txt
```

### 估算完成时间：
如果在 **14:00** 启动，预计 **17:00** 完成

---

## 📱 离开电脑时

如果需要离开3小时：

1. **确保使用了caffeinate**
2. **连接电源**
3. **不要盖上笔记本盖子**（盖上会强制休眠，即使有caffeinate）
4. **可以锁定屏幕**（Cmd+Ctrl+Q），不影响运行

**或者使用远程方式**：
- 通过SSH连接（如已配置）
- 使用TeamViewer等远程桌面

---

## ✅ 执行确认

准备好后，执行以下命令：

```bash
cd /Users/Jason/Desktop/code/AI/parameter
./run_tuning.sh
```

**预期输出**：
```
======================================================================
🚀 开始第五轮参数调优 - 防休眠模式
======================================================================

⏱️  预计运行时间: 3小时
💡 caffeinate将阻止系统休眠
🛑 按Ctrl+C可随时终止

======================================================================

🕐 开始时间: 2025-10-15 14:30:00

🚀 开始第五轮参数调优...
基于最新运行结果 (2025-10-15 00:53):
  - RandomForest: R²=0.9290 (优秀)
  - LSTM: R²=0.574 (严重退化❌，从0.8904崩溃)
  - Transformer: R²=0.7746 (良好✅，稳定)
...
```

---

## 🎉 完成后

调优完成后，检查结果：

```bash
# 查看最终结果
tail -100 parameter_tuning.txt

# 查看详细报告
ls -lh /Users/Jason/Desktop/code/AI/carbon_prediction_log_txt/
```

期待看到：
- ✅ LSTM R² > 0.89
- ✅ Transformer R² > 0.77

---

**准备好了吗？开始优化吧！** 🚀
