# ç¢³ä»·æ ¼é¢„æµ‹ç³»ç»Ÿä½¿ç”¨æŒ‡å—

> æœ¬æŒ‡å—æä¾›è¯¦ç»†çš„å®‰è£…ã€é…ç½®å’Œä½¿ç”¨è¯´æ˜ã€‚å¦‚éœ€é¡¹ç›®æ¦‚è§ˆï¼Œè¯·å…ˆæŸ¥çœ‹ [README.md](./README.md)

ğŸ“– **æ–‡æ¡£å¯¼èˆª**ï¼š
- [README.md](./README.md) - é¡¹ç›®æ¦‚è§ˆå’Œå¿«é€Ÿå¼€å§‹
- æœ¬æ–‡æ¡£ - è¯¦ç»†ä½¿ç”¨è¯´æ˜
- [æŠ€æœ¯çŸ¥è¯†åº“](./model_knowledge/) - æ·±å…¥æŠ€æœ¯åŸç†

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

### Pythonç‰ˆæœ¬
- Python 3.7+ ï¼ˆæ¨è Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰
- å»ºè®®ä½¿ç”¨ Anaconda æˆ– Miniconda è¿›è¡Œç¯å¢ƒç®¡ç†

### ğŸ–¥ï¸ ä¸åŒæ“ä½œç³»ç»Ÿçš„å®‰è£…æŒ‡å—

#### Windows ç”¨æˆ·
1. **å®‰è£…åŸºç¡€ä¾èµ–**ï¼š
```bash
# åŸºç¡€ç§‘å­¦è®¡ç®—åº“
pip install numpy pandas matplotlib seaborn
# æœºå™¨å­¦ä¹ åº“
pip install scikit-learn tensorflow
# æ¢¯åº¦æå‡åº“
pip install xgboost lightgbm
# å¯è§£é‡Šæ€§åˆ†æå’ŒExcelæ”¯æŒ
pip install shap openpyxl
```

2. **å¦‚æœé‡åˆ°å®‰è£…é—®é¢˜**ï¼š
```bash
# ä½¿ç”¨condaå®‰è£…ï¼ˆæ¨èï¼‰
conda install -c conda-forge numpy pandas matplotlib seaborn
conda install -c conda-forge scikit-learn tensorflow
conda install -c conda-forge xgboost lightgbm
conda install -c conda-forge shap openpyxl
```

#### macOS ç”¨æˆ·
1. **é¦–å…ˆå®‰è£…å¿…è¦çš„ç³»ç»Ÿä¾èµ–**ï¼š
```bash
# å®‰è£… Homebrewï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# å®‰è£… OpenMPï¼ˆXGBoost éœ€è¦ï¼‰
brew install libomp
```

2. **å®‰è£… Python ä¾èµ–**ï¼š
```bash
# åŸºç¡€ç§‘å­¦è®¡ç®—åº“
pip install numpy pandas matplotlib seaborn
# æœºå™¨å­¦ä¹ åº“
pip install scikit-learn tensorflow
# æ¢¯åº¦æå‡åº“ï¼ˆmacOS éœ€è¦ç‰¹åˆ«æ³¨æ„ XGBoostï¼‰
pip install xgboost lightgbm
# å¯è§£é‡Šæ€§åˆ†æå’ŒExcelæ”¯æŒ
pip install shap openpyxl
```

#### Linux (Ubuntu/Debian) ç”¨æˆ·
1. **å®‰è£…ç³»ç»Ÿä¾èµ–**ï¼š
```bash
# æ›´æ–°åŒ…åˆ—è¡¨
sudo apt update
# å®‰è£…ç¼–è¯‘å·¥å…·
sudo apt install build-essential python3-dev
# å®‰è£… OpenMP
sudo apt install libomp-dev
```

2. **å®‰è£… Python ä¾èµ–**ï¼š
```bash
# åŸºç¡€ç§‘å­¦è®¡ç®—åº“
pip install numpy pandas matplotlib seaborn
# æœºå™¨å­¦ä¹ åº“
pip install scikit-learn tensorflow
# æ¢¯åº¦æå‡åº“
pip install xgboost lightgbm
# å¯è§£é‡Šæ€§åˆ†æå’ŒExcelæ”¯æŒ
pip install shap openpyxl
```

### âš ï¸ é‡è¦æç¤º
- **macOS ç”¨æˆ·**ï¼šå¿…é¡»å®‰è£… `libomp`ï¼Œå¦åˆ™ XGBoost ä¼šæŠ¥é”™
- **Windows ç”¨æˆ·**ï¼šå»ºè®®ä½¿ç”¨ Anacondaï¼Œé¿å…ç¼–è¯‘é—®é¢˜
- **æ‰€æœ‰ç”¨æˆ·**ï¼šå¦‚æœé‡åˆ° TensorFlow å®‰è£…é—®é¢˜ï¼Œå¯ä»¥å°è¯•å®‰è£… CPU ç‰ˆæœ¬ï¼š`pip install tensorflow-cpu`

### ğŸ”§ éªŒè¯å®‰è£…
è¿è¡Œä»¥ä¸‹ä»£ç éªŒè¯æ‰€æœ‰åº“æ˜¯å¦æ­£ç¡®å®‰è£…ï¼š
```python
# éªŒè¯å®‰è£…è„šæœ¬
import sys
print(f"Python ç‰ˆæœ¬: {sys.version}")

try:
    import numpy as np
    import pandas as pd
    import matplotlib.pyplot as plt
    import seaborn as sns
    import sklearn
    import tensorflow as tf
    import xgboost as xgb
    import lightgbm as lgb
    import shap
    import openpyxl
    print("âœ… æ‰€æœ‰å¿…éœ€åº“å·²æˆåŠŸå®‰è£…ï¼")
except ImportError as e:
    print(f"âŒ å®‰è£…å¤±è´¥: {e}")
    print("è¯·é‡æ–°å®‰è£…ç›¸åº”çš„åº“")
```

### å¯é€‰ä¾èµ–ï¼ˆç”¨äºæ‰©å±•åŠŸèƒ½ï¼‰
```bash
pip install yfinance  # ç”¨äºè·å–é‡‘èæ•°æ®
pip install PyEMD     # ç”¨äºEMDåˆ†è§£
```


## ğŸ’» è¯¦ç»†ä½¿ç”¨è¯´æ˜

#### æ–¹æ³•1ï¼šå¿«é€Ÿå¼€å§‹ï¼ˆæ¨èæ–°æ‰‹ï¼‰
```python
from carbon_price_prediction import CarbonPricePredictionSystem

# åŸºæœ¬ç”¨æ³•
system = CarbonPricePredictionSystem()
system.run_complete_analysis('ä½ çš„æ•°æ®æ–‡ä»¶.xlsx')
```

### æ–¹æ³•2ï¼šè‡ªå®šä¹‰é…ç½®ï¼ˆæ¨èè¿›é˜¶ç”¨æˆ·ï¼‰
```python
# å¦‚æœä½ çš„æ•°æ®åˆ—åä¸é»˜è®¤ä¸åŒï¼Œéœ€è¦è‡ªå®šä¹‰é…ç½®
custom_config = {
    'target_column': 'ä½ çš„ç¢³ä»·æ ¼åˆ—å',  # å¦‚ï¼š'price', 'ç¢³ä»·æ ¼', 'æ’æ”¾ä»·æ ¼'ç­‰
    'sequence_length': 60,           # æ—¶é—´åºåˆ—é•¿åº¦ï¼Œå¯æ ¹æ®æ•°æ®è°ƒæ•´
    'test_size': 0.2,               # æµ‹è¯•é›†æ¯”ä¾‹
    'validation_size': 0.1,         # éªŒè¯é›†æ¯”ä¾‹
    'lstm_config': {
        'units': [64, 32],           # LSTMç½‘ç»œç»“æ„
        'epochs': 100                # è®­ç»ƒè½®æ•°
    }
}
system = CarbonPricePredictionSystem(config=custom_config)
system.run_complete_analysis('ä½ çš„æ•°æ®æ–‡ä»¶.xlsx')
```

### æ–¹æ³•3ï¼šåˆ†æ­¥æ‰§è¡Œï¼ˆæ¨èä¸“ä¸šç”¨æˆ·ï¼‰
```python
system = CarbonPricePredictionSystem()

# 1. åŠ è½½ä½ çš„æ•°æ®
system.load_data('ä½ çš„æ•°æ®æ–‡ä»¶.xlsx', sheet_name='å·¥ä½œè¡¨å')  # å¯é€‰å·¥ä½œè¡¨å

# 2. æ£€æŸ¥æ•°æ®æ˜¯å¦æ­£ç¡®åŠ è½½
print(system.data.head())  # æŸ¥çœ‹æ•°æ®å‰5è¡Œ
print(system.data.info())  # æŸ¥çœ‹æ•°æ®ä¿¡æ¯

# 3. å¦‚æœéœ€è¦ï¼Œä¿®æ”¹ç›®æ ‡åˆ—å
if 'ä½ çš„ç¢³ä»·æ ¼åˆ—å' in system.data.columns:
    system.config['target_column'] = 'ä½ çš„ç¢³ä»·æ ¼åˆ—å'

# 4. æ‰§è¡Œå®Œæ•´åˆ†æ
system.preprocess_data()         # æ•°æ®é¢„å¤„ç†
system.train_models()            # è®­ç»ƒæ¨¡å‹
system.evaluate_models()         # è¯„ä¼°æ€§èƒ½
system.perform_shap_analysis()   # SHAPåˆ†æ
system.create_visualizations()   # ç”Ÿæˆå›¾è¡¨
system.generate_report()         # ç”ŸæˆæŠ¥å‘Š
```

### æ•°æ®å‡†å¤‡æ£€æŸ¥æ¸…å•
- âœ… æ–‡ä»¶æ ¼å¼ï¼šExcel(.xlsx/.xls) æˆ– CSV(.csv)
- âœ… ç¬¬ä¸€åˆ—ï¼šæ—¥æœŸï¼ˆä½œä¸ºç´¢å¼•ï¼‰ï¼Œæ ¼å¼æ­£ç¡®
- âœ… æ•°æ®é‡ï¼šè‡³å°‘500è¡Œï¼Œæ¨è1000+è¡Œ
- âœ… ç¢³ä»·æ ¼åˆ—ï¼šåŒ…å«ç›®æ ‡å˜é‡
- âœ… å½±å“å› å­ï¼š8-15ä¸ªç›¸å…³å˜é‡
- âœ… æ•°æ®è´¨é‡ï¼šæ— å¼‚å¸¸å€¼ï¼Œç¼ºå¤±å€¼<5%
- âœ… æ—¶é—´è¿ç»­ï¼šæŒ‰æ—¶é—´é¡ºåºæ’åˆ—

### å¸¸è§é—®é¢˜è§£å†³
**Q: æç¤ºæ‰¾ä¸åˆ°ç¢³ä»·æ ¼åˆ—ï¼Ÿ**
A: åœ¨configä¸­æŒ‡å®šï¼š`{'target_column': 'ä½ çš„åˆ—å'}`

**Q: æ•°æ®åŠ è½½å¤±è´¥ï¼Ÿ**
A: æ£€æŸ¥æ–‡ä»¶è·¯å¾„å’Œæ ¼å¼ï¼Œç¡®ä¿ç¬¬ä¸€åˆ—æ˜¯æ—¥æœŸ

**Q: æ¨¡å‹æ€§èƒ½ä¸ä½³ï¼Ÿ**
A: 1) å¢åŠ æ•°æ®é‡ 2) æ£€æŸ¥æ•°æ®è´¨é‡ 3) å¢åŠ ç›¸å…³ç‰¹å¾

**Q: æƒ³è°ƒæ•´æ¨¡å‹å‚æ•°ï¼Ÿ**
A: ä¿®æ”¹configä¸­çš„lstm_configå’Œtransformer_config

### é¢„æœŸè¾“å‡ºæ–‡ä»¶

è¿è¡Œç³»ç»Ÿåï¼Œå°†åœ¨ä»¥ä¸‹ç›®å½•ä¸­ç”Ÿæˆæ–‡ä»¶ï¼š

#### ğŸ“ carbon_prediction_log_txt/ - æ–‡æœ¬æŠ¥å‘Šç›®å½•
- `carbon_price_prediction_YYYYMMDD_HHMMSS_detailed_report.txt` - è¯¦ç»†åˆ†ææŠ¥å‘Š
- `carbon_price_prediction_YYYYMMDD_HHMMSS_runtime_log.txt` - è¿è¡Œæ—¥å¿—

#### ğŸ“ carbon_prediction_results_excel/ - ExcelæŠ¥å‘Šç›®å½•  
- `carbon_price_prediction_YYYYMMDD_HHMMSS_report.xlsx` - ç»¼åˆExcelæŠ¥å‘Šï¼ŒåŒ…å«6ä¸ªå·¥ä½œè¡¨ï¼š
  - æ•°æ®æ¦‚è¦ï¼šæ•°æ®çš„æè¿°æ€§ç»Ÿè®¡ä¿¡æ¯
  - æ¨¡å‹æ€§èƒ½ï¼šæ‰€æœ‰æ¨¡å‹çš„æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”
  - ç‰¹å¾é‡è¦æ€§ï¼šSHAPåˆ†æçš„ç‰¹å¾é‡è¦æ€§æ’åº
  - æœ€ä½³æ¨¡å‹é¢„æµ‹ç»“æœï¼šå®é™…å€¼ã€é¢„æµ‹å€¼å’Œè¯¯å·®
  - ç³»ç»Ÿé…ç½®ï¼šæ‰€æœ‰é…ç½®å‚æ•°å’Œç³»ç»Ÿä¿¡æ¯
  - æ•°æ®è´¨é‡ï¼šæ•°æ®å®Œæ•´æ€§ã€è´¨é‡æŒ‡æ ‡

#### ğŸ“ carbon_prediction_results_pic/ - å¯è§†åŒ–å›¾è¡¨ç›®å½•
- `*_model_performance_comparison.png` - æ¨¡å‹æ€§èƒ½å¯¹æ¯”å›¾ï¼ˆ5ä¸ªæŒ‡æ ‡ï¼‰
- `*_prediction_comparison.png` - é¢„æµ‹ç»“æœå¯¹æ¯”å›¾ï¼ˆæœ€å¤„4ä¸ªæ¨¡å‹ï¼‰
- `*_shap_summary_plot.png` - SHAPç‰¹å¾é‡è¦æ€§æ€»ç»“å›¾
- `*_shap_bar_plot.png` - SHAPé‡è¦æ€§æ¡å½¢å›¾
- `*_shap_dependence_plots.png` - SHAPä¾èµ–å…³ç³»å›¾ï¼ˆå‰4ä¸ªé‡è¦ç‰¹å¾ï¼‰
- `*_training_history.png` - æ¨¡å‹è®­ç»ƒå†å²å›¾ï¼ˆLSTMå’ŒTransformerï¼‰
data_file = 'æ‚¨çš„æ•°æ®æ–‡ä»¶.xlsx'  # åœ¨è¿™é‡Œä¿®æ”¹æ‚¨çš„æ–‡ä»¶å

try:
    system.load_data(data_file)
    print(f"âœ… æˆåŠŸåŠ è½½æ•°æ®æ–‡ä»¶: {data_file}")
except FileNotFoundError:
    print(f"âŒ æ‰¾ä¸åˆ°æ–‡ä»¶: {data_file}")
    print("è¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®")
    exit()

# 4. è¿è¡Œå®Œæ•´åˆ†æ
print("ğŸš€ å¼€å§‹æ•°æ®åˆ†æ...")
system.preprocess_data()
system.train_models()
system.evaluate_models()
system.perform_shap_analysis()
system.create_visualizations()
system.generate_report()
print("âœ… åˆ†æå®Œæˆï¼è¯·æŸ¥çœ‹ç”Ÿæˆçš„æŠ¥å‘Šå’Œå›¾è¡¨")
```

## ğŸ“Š æ•°æ®æ ¼å¼è¦æ±‚ï¼ˆæ–°æ‰‹å¿…è¯»ï¼‰

### ğŸ“‹ Excelæ–‡ä»¶åŸºæœ¬è¦æ±‚

#### ğŸ” æ–‡ä»¶æ ¼å¼æ£€æŸ¥æ¸…å•
- âœ… æ–‡ä»¶æ ¼å¼ï¼š`.xlsx` æˆ– `.xls`
- âœ… ç¬¬ä¸€è¡Œï¼šåˆ—åï¼ˆè¡¨å¤´ï¼‰
- âœ… æ•°æ®ä»ç¬¬äºŒè¡Œå¼€å§‹
- âœ… æ²¡æœ‰åˆå¹¶å•å…ƒæ ¼
- âœ… æ²¡æœ‰ç©ºç™½è¡Œåœ¨æ•°æ®ä¸­é—´
- âœ… æ—¥æœŸæ ¼å¼ç»Ÿä¸€
- âœ… æ•°å€¼åˆ—åªåŒ…å«æ•°å­—ï¼ˆä¸èƒ½æœ‰æ–‡å­—ï¼‰

### ğŸ“Š æ ‡å‡†æ•°æ®æ ¼å¼ç¤ºä¾‹

æ‚¨çš„Excelæ–‡ä»¶åº”è¯¥åƒè¿™æ ·ï¼ˆæœ€å°‘éœ€è¦å‰2åˆ—ï¼‰ï¼š

| æ—¥æœŸ | carbon_price | gdp_growth | oil_price | gas_price | electricity_demand | temperature | policy_impact | emissions |
|------|--------------|------------|-----------|-----------|-------------------|-------------|---------------|-----------|
| 2020-01-01 | 50.25 | 2.1 | 65.3 | 3.2 | 1200 | 15.2 | 0 | 950 |
| 2020-01-02 | 51.10 | 2.1 | 66.1 | 3.3 | 1180 | 14.8 | 0 | 945 |
| 2020-01-03 | 49.80 | 2.0 | 64.8 | 3.1 | 1220 | 16.1 | 0 | 955 |

### ğŸ“ åˆ—åè¯¦ç»†è¯´æ˜

#### ğŸš¨ å¿…éœ€åˆ—ï¼ˆè‡³å°‘è¦æœ‰è¿™äº›ï¼‰
1. **æ—¥æœŸåˆ—**ï¼š
   - **åˆ—åå¯ä»¥æ˜¯**ï¼š`æ—¥æœŸ`ã€`date`ã€`Date`ã€`æ—¶é—´`ã€`timestamp`
   - **æ ¼å¼è¦æ±‚**ï¼šYYYY-MM-DDï¼ˆå¦‚ï¼š2020-01-01ï¼‰
   - **æ³¨æ„**ï¼šå¿…é¡»æ˜¯è¿ç»­çš„æ—¥æœŸï¼Œä¸èƒ½è·³è·ƒ

2. **carbon_price**ï¼š
   - **è¯´æ˜**ï¼šç¢³ä»·æ ¼ï¼ˆè¿™æ˜¯æˆ‘ä»¬è¦é¢„æµ‹çš„ç›®æ ‡ï¼‰
   - **å•ä½**ï¼šå…ƒ/å¨ æˆ– ç¾å…ƒ/å¨
   - **æ ¼å¼**ï¼šçº¯æ•°å­—ï¼Œå¦‚ï¼š50.25
   - **æ³¨æ„**ï¼šä¸èƒ½æœ‰æ–‡å­—ï¼Œå¦‚"50.25å…ƒ"

#### ğŸ’¡ å»ºè®®çš„å½±å“å› å­åˆ—ï¼ˆæœ‰åŠ©äºæé«˜é¢„æµ‹å‡†ç¡®æ€§ï¼‰

3. **gdp_growth**: GDPå¢é•¿ç‡ï¼ˆ%ï¼‰
4. **oil_price**: çŸ³æ²¹ä»·æ ¼ï¼ˆç¾å…ƒ/æ¡¶ï¼‰
5. **gas_price**: å¤©ç„¶æ°”ä»·æ ¼ï¼ˆç¾å…ƒ/ç«‹æ–¹ç±³ï¼‰
6. **electricity_demand**: ç”µåŠ›éœ€æ±‚ï¼ˆå…†ç“¦æ—¶ï¼‰
7. **temperature**: æ¸©åº¦ï¼ˆæ‘„æ°åº¦ï¼‰
8. **policy_impact**: æ”¿ç­–å½±å“æŒ‡æ•°ï¼ˆ0-10åˆ†ï¼‰
9. **emissions**: ç¢³æ’æ”¾é‡ï¼ˆå¨ï¼‰
10. **industrial_production**: å·¥ä¸šç”Ÿäº§æŒ‡æ•°

### ğŸ› ï¸ æ•°æ®å‡†å¤‡æ­¥éª¤æŒ‡å—

#### æ­¥éª¤1ï¼šåˆ›å»ºExcelæ–‡ä»¶
1. æ‰“å¼€Excelæˆ–Google Sheets
2. åœ¨A1å•å…ƒæ ¼è¾“å…¥"æ—¥æœŸ"
3. åœ¨B1å•å…ƒæ ¼è¾“å…¥"carbon_price"
4. åœ¨C1ã€D1ç­‰å•å…ƒæ ¼è¾“å…¥å…¶ä»–å½±å“å› å­åç§°

#### æ­¥éª¤2ï¼šå¡«å…¥æ•°æ®
1. **æ—¥æœŸåˆ—**ï¼šä»A2å¼€å§‹ï¼Œå¡«å…¥è¿ç»­æ—¥æœŸ
   ```
   A2: 2020-01-01
   A3: 2020-01-02
   A4: 2020-01-03
   ...
   ```

2. **ç¢³ä»·æ ¼åˆ—**ï¼šä»B2å¼€å§‹ï¼Œå¡«å…¥å¯¹åº”çš„ç¢³ä»·æ ¼
   ```
   B2: 50.25
   B3: 51.10
   B4: 49.80
   ...
   ```

3. **å…¶ä»–åˆ—**ï¼šå¡«å…¥ç›¸åº”çš„æ•°å€¼æ•°æ®

#### æ­¥éª¤3ï¼šæ•°æ®è´¨é‡æ£€æŸ¥
```python
# æ•°æ®æ£€æŸ¥ä»£ç ï¼ˆè¿è¡Œåˆ†æå‰ä½¿ç”¨ï¼‰
import pandas as pd

# è¯»å–æ‚¨çš„æ•°æ®
df = pd.read_excel('æ‚¨çš„æ•°æ®æ–‡ä»¶.xlsx')

# åŸºæœ¬ä¿¡æ¯æ£€æŸ¥
print("æ•°æ®å½¢çŠ¶:", df.shape)
print("åˆ—å:", df.columns.tolist())
print("å‰5è¡Œæ•°æ®:")
print(df.head())

# æ£€æŸ¥ç¼ºå¤±å€¼
print("\nç¼ºå¤±å€¼ç»Ÿè®¡:")
print(df.isnull().sum())

# æ£€æŸ¥æ•°æ®ç±»å‹
print("\næ•°æ®ç±»å‹:")
print(df.dtypes)
```

### âš ï¸ å¸¸è§æ•°æ®é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

#### é—®é¢˜1ï¼šæ—¥æœŸæ ¼å¼é”™è¯¯
```
âŒ é”™è¯¯æ ¼å¼: "2020å¹´1æœˆ1æ—¥", "01/01/2020", "1-1-2020"
âœ… æ­£ç¡®æ ¼å¼: "2020-01-01"
```

#### é—®é¢˜2ï¼šæ•°å€¼ä¸­åŒ…å«æ–‡å­—
```
âŒ é”™è¯¯æ ¼å¼: "50.25å…ƒ", "$50.25", "50.25 USD"
âœ… æ­£ç¡®æ ¼å¼: "50.25"
```

#### é—®é¢˜3ï¼šç¼ºå¤±å€¼å¤„ç†
```
âŒ é”™è¯¯åšæ³•: ç•™ç©ºæˆ–å¡«å…¥"æ— æ•°æ®"
âœ… æ­£ç¡®åšæ³•: åˆ é™¤è¯¥è¡Œæˆ–ç”¨åˆç†æ•°å€¼å¡«å……
```

#### é—®é¢˜4ï¼šåˆ—ååŒ…å«ç‰¹æ®Šå­—ç¬¦
```
âŒ é”™è¯¯æ ¼å¼: "ç¢³ä»·æ ¼ï¼ˆå…ƒ/å¨ï¼‰", "GDPå¢é•¿ç‡%"
âœ… æ­£ç¡®æ ¼å¼: "carbon_price", "gdp_growth"
```

### ğŸ“ æ•°æ®æ–‡ä»¶ç¤ºä¾‹ä¸‹è½½

è¿è¡Œç³»ç»Ÿæ—¶ä¼šè‡ªåŠ¨ç”Ÿæˆç¤ºä¾‹æ•°æ®æ–‡ä»¶ `carbon_price_sample_data.xlsx`ï¼Œæ‚¨å¯ä»¥å‚è€ƒè¿™ä¸ªæ–‡ä»¶çš„æ ¼å¼æ¥å‡†å¤‡è‡ªå·±çš„æ•°æ®ã€‚

### ğŸ“Š æœ€å°æ•°æ®è¦æ±‚

- **æœ€å°‘è¡Œæ•°**ï¼š100è¡Œæ•°æ®ï¼ˆå»ºè®®300è¡Œä»¥ä¸Šï¼‰
- **å¿…éœ€åˆ—æ•°**ï¼š2åˆ—ï¼ˆæ—¥æœŸ + ç¢³ä»·æ ¼ï¼‰
- **å»ºè®®åˆ—æ•°**ï¼š5-10åˆ—ï¼ˆåŒ…å«å¤šä¸ªå½±å“å› å­ï¼‰
- **æ—¶é—´è·¨åº¦**ï¼šå»ºè®®è‡³å°‘6ä¸ªæœˆçš„æ•°æ®

## ğŸ”§ ç³»ç»Ÿé…ç½®è¯¦è§£

### ğŸ”§ å…¨å±€é…ç½®å‚æ•°

ç³»ç»Ÿä½¿ç”¨å…¨å±€é…ç½®å¸¸é‡ï¼Œæ–¹ä¾¿ç»Ÿä¸€ç®¡ç†å’Œä¿®æ”¹ï¼š

```python
# é»˜è®¤æ•°æ®æ–‡ä»¶é…ç½®
DEFAULT_DATA_FILE = 'carbon_price_prediction_test_data.xlsx'  # é»˜è®¤æµ‹è¯•æ•°æ®
SAMPLE_DATA_FILE = 'carbon_price_prediction_test_data.xlsx'  # ç¤ºä¾‹æ•°æ®

# è¾“å‡ºç›®å½•é…ç½®
OUTPUT_DIRS = {
    'txt': 'carbon_prediction_log_txt',      # æ–‡æœ¬æ—¥å¿—ç›®å½•
    'excel': 'carbon_prediction_results_excel',  # ExcelæŠ¥å‘Šç›®å½•
    'pic': 'carbon_prediction_results_pic'   # å›¾è¡¨ç›®å½•
}

# æ–‡ä»¶å‘½åæ ¼å¼
FILE_NAME_FORMAT = {
    'program_name': 'carbon_price_prediction',
    'timestamp_format': '%Y%m%d_%H%M%S'
}
```

### ğŸ“Š é»˜è®¤æ¨¡å‹é…ç½®

```python
DEFAULT_CONFIG = {
    'target_column': 'carbon_price',      # ç›®æ ‡åˆ—å
    'sequence_length': 60,                # åºåˆ—é•¿åº¦
    'test_size': 0.2,                    # æµ‹è¯•é›†æ¯”ä¾‹
    'validation_size': 0.1,              # éªŒè¯é›†æ¯”ä¾‹
    'random_state': 42,                  # éšæœºç§å­
    'lstm_config': {
        'units': [64, 32],               # LSTMå±‚å•å…ƒæ•°
        'dropout': 0.2,                  # Dropoutç‡
        'epochs': 100,                   # è®­ç»ƒè½®æ•°
        'batch_size': 32                 # æ‰¹å¤§å°
    },
    'transformer_config': {
        'd_model': 128,                  # æ¨¡å‹ç»´åº¦
        'num_heads': 8,                  # æ³¨æ„åŠ›å¤´æ•°
        'num_layers': 4,                 # ç¼–ç å™¨å±‚æ•°
        'dff': 512,                      # å‰é¦ˆç½‘ç»œç»´åº¦
        'dropout': 0.1,                  # Dropoutç‡
        'epochs': 50                     # è®­ç»ƒè½®æ•°
    }
}
```

### ğŸ›ï¸ é…ç½®å‚æ•°è¯¦ç»†è¯´æ˜

#### target_columnï¼ˆç›®æ ‡åˆ—åï¼‰
- **é»˜è®¤å€¼**: `'carbon_price'`
- **è¯´æ˜**: ç¢³ä»·æ ¼åˆ—çš„åç§°ï¼ˆé¢„æµ‹ç›®æ ‡ï¼‰
- **å¸¸è§å€¼**: `'price'`, `'ç¢³ä»·æ ¼'`, `'carbon_price_eur'`, `'emission_price'`
- **ä¿®æ”¹æ–¹æ³•**:
  ```python
  config = {'target_column': 'ä½ çš„ç¢³ä»·æ ¼åˆ—å'}
  system = CarbonPricePredictionSystem(config=config)
  ```

#### sequence_lengthï¼ˆæ—¶é—´åºåˆ—é•¿åº¦ï¼‰
- **é»˜è®¤å€¼**: `60`
- **è¯´æ˜**: LSTM/Transformeræ¨¡å‹çš„è¾“å…¥åºåˆ—é•¿åº¦ï¼ˆå¤©æ•°ï¼‰
- **å»ºè®®èŒƒå›´**: 30-120
- **é€‰æ‹©ä¾æ®**: 
  - çŸ­æœŸé¢„æµ‹ï¼š30-60å¤©
  - ä¸­æœŸé¢„æµ‹ï¼š60-90å¤©
  - é•¿æœŸé¢„æµ‹ï¼š90-120å¤©

#### test_sizeï¼ˆæµ‹è¯•é›†æ¯”ä¾‹ï¼‰
- **é»˜è®¤å€¼**: `0.2` (20%)
- **è¯´æ˜**: ç”¨äºæœ€ç»ˆæ¨¡å‹è¯„ä¼°çš„æ•°æ®æ¯”ä¾‹
- **å»ºè®®èŒƒå›´**: 0.1-0.3

#### validation_sizeï¼ˆéªŒè¯é›†æ¯”ä¾‹ï¼‰
- **é»˜è®¤å€¼**: `0.1` (10%)
- **è¯´æ˜**: ç”¨äºæ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­éªŒè¯å’Œè°ƒå‚çš„æ•°æ®æ¯”ä¾‹
- **å»ºè®®èŒƒå›´**: 0.05-0.15

#### LSTMé…ç½®è¯¦è§£

**unitsï¼ˆéšè—å±‚å•å…ƒæ•°ï¼‰**
- **é»˜è®¤å€¼**: `[64, 32]`
- **è¯´æ˜**: æ¯å±‚LSTMçš„ç¥ç»å…ƒæ•°é‡
- **æ€§èƒ½å…³ç³»**:
  - æ›´å¤šå•å…ƒ = æ›´å¼ºå­¦ä¹ èƒ½åŠ›ï¼Œä½†è®¡ç®—é‡å¤§
  - æ›´å°‘å•å…ƒ = è®¡ç®—å¿«ï¼Œä½†å¯èƒ½æ¬ æ‹Ÿåˆ
- **æ¨èé…ç½®**:
  ```python
  # ç®€å•æ¨¡å‹ï¼ˆå¿«é€Ÿè®­ç»ƒï¼‰
  'units': [32, 16]
  
  # æ ‡å‡†æ¨¡å‹ï¼ˆå¹³è¡¡æ€§èƒ½ï¼‰
  'units': [64, 32]
  
  # å¤æ‚æ¨¡å‹ï¼ˆé«˜ç²¾åº¦ï¼‰
  'units': [128, 64, 32]
  ```

**dropoutï¼ˆéšæœºå¤±æ´»ç‡ï¼‰**
- **é»˜è®¤å€¼**: `0.2`
- **è¯´æ˜**: é˜²æ­¢è¿‡æ‹Ÿåˆçš„æ­£åˆ™åŒ–æŠ€æœ¯
- **å»ºè®®èŒƒå›´**: 0.1-0.5
- **è°ƒä¼˜æŒ‡å—**:
  - è¿‡æ‹Ÿåˆä¸¥é‡ï¼šå¢åŠ åˆ°0.3-0.5
  - æ¬ æ‹Ÿåˆï¼šå‡å°‘åˆ°0.1-0.2

**epochsï¼ˆè®­ç»ƒè½®æ•°ï¼‰**
- **é»˜è®¤å€¼**: `100`
- **è¯´æ˜**: æ¨¡å‹è®­ç»ƒçš„å®Œæ•´è½®æ•°
- **è°ƒä¼˜å»ºè®®**:
  - æ•°æ®é‡å°ï¼š50-100è½®
  - æ•°æ®é‡å¤§ï¼š100-200è½®
  - é…åˆæ—©åœæœºåˆ¶é˜²æ­¢è¿‡æ‹Ÿåˆ

**batch_sizeï¼ˆæ‰¹å¤„ç†å¤§å°ï¼‰**
- **é»˜è®¤å€¼**: `32`
- **è¯´æ˜**: æ¯æ¬¡è®­ç»ƒä½¿ç”¨çš„æ ·æœ¬æ•°é‡
- **é€‰æ‹©ä¾æ®**:
  - å†…å­˜å……è¶³ï¼š64-128
  - å†…å­˜æœ‰é™ï¼š16-32
  - æ•°æ®é‡å°ï¼š8-16

#### Transformeré…ç½®è¯¦è§£

**d_modelï¼ˆæ¨¡å‹ç»´åº¦ï¼‰**
- **é»˜è®¤å€¼**: `128`
- **è¯´æ˜**: Transformerçš„éšè—å±‚ç»´åº¦
- **æ¨èå€¼**: 64, 128, 256, 512

**num_headsï¼ˆæ³¨æ„åŠ›å¤´æ•°ï¼‰**
- **é»˜è®¤å€¼**: `8`
- **è¯´æ˜**: å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶çš„å¤´æ•°
- **è¦æ±‚**: å¿…é¡»èƒ½è¢«d_modelæ•´é™¤
- **æ¨èç»„åˆ**:
  - d_model=128, num_heads=8
  - d_model=256, num_heads=16

**num_layersï¼ˆç¼–ç å™¨å±‚æ•°ï¼‰**
- **é»˜è®¤å€¼**: `4`
- **è¯´æ˜**: Transformerç¼–ç å™¨çš„å±‚æ•°
- **å»ºè®®èŒƒå›´**: 2-8å±‚

**dffï¼ˆå‰é¦ˆç½‘ç»œç»´åº¦ï¼‰**
- **é»˜è®¤å€¼**: `512`
- **è¯´æ˜**: å‰é¦ˆç¥ç»ç½‘ç»œçš„éšè—å±‚ç»´åº¦
- **é€šå¸¸è®¾ç½®**: d_modelçš„2-4å€

### ğŸ“‹ è‡ªå®šä¹‰é…ç½®å®Œæ•´ç¤ºä¾‹

#### åŸºç¡€é…ç½®ç¤ºä¾‹
```python
# åŸºç¡€ç”¨æ³•ï¼ˆä½¿ç”¨é»˜è®¤é…ç½®ï¼‰
system = CarbonPricePredictionSystem()
system.run_complete_analysis('ä½ çš„æ•°æ®.xlsx')

# ä¿®æ”¹ç›®æ ‡åˆ—å
config = {'target_column': 'ç¢³æ’æ”¾ä»·æ ¼'}
system = CarbonPricePredictionSystem(config=config)
```

#### æ€§èƒ½ä¼˜åŒ–é…ç½®
```python
# é«˜æ€§èƒ½é…ç½®ï¼ˆé€‚åˆå¤§æ•°æ®é›†ï¼‰
high_performance_config = {
    'target_column': 'carbon_price',
    'sequence_length': 90,           # æ›´é•¿çš„åºåˆ—
    'test_size': 0.15,              # æ›´å°çš„æµ‹è¯•é›†
    'lstm_config': {
        'units': [128, 64, 32],      # æ›´æ·±çš„ç½‘ç»œ
        'dropout': 0.3,              # æ›´å¼ºçš„æ­£åˆ™åŒ–
        'epochs': 200,               # æ›´å¤šè®­ç»ƒè½®æ•°
        'batch_size': 64             # æ›´å¤§çš„æ‰¹å¤„ç†
    },
    'transformer_config': {
        'd_model': 256,              # æ›´å¤§çš„æ¨¡å‹
        'num_heads': 16,
        'num_layers': 6,
        'dff': 1024,
        'dropout': 0.2,
        'epochs': 100
    }
}
system = CarbonPricePredictionSystem(config=high_performance_config)
```

#### å¿«é€Ÿè¯•éªŒé…ç½®
```python
# å¿«é€Ÿè¯•éªŒé…ç½®ï¼ˆé€‚åˆæµ‹è¯•å’Œå¿«é€ŸéªŒè¯ï¼‰
fast_test_config = {
    'sequence_length': 30,           # æ›´çŸ­çš„åºåˆ—
    'lstm_config': {
        'units': [32, 16],           # æ›´å°çš„ç½‘ç»œ
        'epochs': 50,                # æ›´å°‘è®­ç»ƒè½®æ•°
        'batch_size': 16
    },
    'transformer_config': {
        'd_model': 64,
        'num_heads': 4,
        'num_layers': 2,
        'dff': 256,
        'epochs': 25
    }
}
system = CarbonPricePredictionSystem(config=fast_test_config)
```

#### å†…å­˜ä¼˜åŒ–é…ç½®
```python
# ä½å†…å­˜é…ç½®ï¼ˆé€‚åˆå†…å­˜æœ‰é™çš„æœºå™¨ï¼‰
low_memory_config = {
    'sequence_length': 30,
    'lstm_config': {
        'units': [32, 16],
        'batch_size': 8,             # å°æ‰¹å¤„ç†
        'epochs': 50
    },
    'transformer_config': {
        'd_model': 64,
        'num_heads': 4,
        'num_layers': 2,
        'epochs': 25
    }
}
system = CarbonPricePredictionSystem(config=low_memory_config)
```

### ğŸ“ æ–‡ä»¶è·¯å¾„ç®¡ç†

ç³»ç»Ÿä½¿ç”¨å…¨å±€å¸¸é‡ç®¡ç†æ–‡ä»¶è·¯å¾„ï¼Œæ–¹ä¾¿ç»Ÿä¸€ä¿®æ”¹ï¼š

```python
# ä¿®æ”¹é»˜è®¤æ•°æ®æ–‡ä»¶
DEFAULT_DATA_FILE = 'ä½ çš„é»˜è®¤æ•°æ®.xlsx'

# ä¿®æ”¹è¾“å‡ºç›®å½•
OUTPUT_DIRS = {
    'txt': 'ä½ çš„æ—¥å¿—ç›®å½•',
    'excel': 'ä½ çš„æŠ¥å‘Šç›®å½•',
    'pic': 'ä½ çš„å›¾è¡¨ç›®å½•'
}

# ä¿®æ”¹æ–‡ä»¶å‘½åæ ¼å¼
FILE_NAME_FORMAT = {
    'program_name': 'ä½ çš„ç¨‹åºå',
    'timestamp_format': '%Y%m%d_%H%M%S'
}
```

### ğŸ“Š é…ç½®ä¼˜åŒ–æŒ‡å—

#### æ ¹æ®æ•°æ®é‡è°ƒæ•´

**å°æ•°æ®é›†ï¼ˆ<1000ä¸ªæ•°æ®ç‚¹ï¼‰**
```python
small_data_config = {
    'sequence_length': 30,
    'test_size': 0.3,               # æ›´å¤§çš„æµ‹è¯•é›†
    'lstm_config': {
        'units': [32, 16],           # æ›´å°çš„ç½‘ç»œ
        'epochs': 100,
        'batch_size': 8
    }
}
```

**å¤§æ•°æ®é›†ï¼ˆ>5000ä¸ªæ•°æ®ç‚¹ï¼‰**
```python
large_data_config = {
    'sequence_length': 120,
    'test_size': 0.15,              # æ›´å°çš„æµ‹è¯•é›†
    'lstm_config': {
        'units': [256, 128, 64],     # æ›´å¤§çš„ç½‘ç»œ
        'epochs': 300,
        'batch_size': 128
    }
}
```

#### æ ¹æ®é¢„æµ‹ç›®æ ‡è°ƒæ•´

**çŸ­æœŸé¢„æµ‹ï¼ˆ1-7å¤©ï¼‰**
```python
short_term_config = {
    'sequence_length': 30,
    'lstm_config': {
        'units': [64, 32],
        'epochs': 150
    }
}
```

**é•¿æœŸé¢„æµ‹ï¼ˆ>30å¤©ï¼‰**
```python
long_term_config = {
    'sequence_length': 120,
    'lstm_config': {
        'units': [128, 64, 32],
        'epochs': 200
    }
}
```

## ğŸ“ˆ è¾“å‡ºç»“æœè¯´æ˜

### ç”Ÿæˆæ–‡ä»¶
è¿è¡Œå®Œæ•´åˆ†æåï¼Œç³»ç»Ÿä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

1. **carbon_price_sample_data.xlsx**: ç¤ºä¾‹æ•°æ®æ–‡ä»¶
2. **carbon_prediction_report.xlsx**: è¯¦ç»†åˆ†ææŠ¥å‘Š
3. **carbon_prediction_results/**: å¯è§†åŒ–å›¾è¡¨æ–‡ä»¶å¤¹
   - `model_performance_comparison.png`: æ¨¡å‹æ€§èƒ½å¯¹æ¯”
   - `prediction_comparison.png`: é¢„æµ‹ç»“æœå¯¹æ¯”
   - `shap_summary_plot.png`: SHAPç‰¹å¾é‡è¦æ€§
   - `shap_bar_plot.png`: SHAPé‡è¦æ€§æ¡å½¢å›¾
   - `shap_dependence_plots.png`: SHAPä¾èµ–å›¾
   - `training_history.png`: è®­ç»ƒå†å²

### è¯„ä¼°æŒ‡æ ‡è¯´æ˜
ç³»ç»Ÿæä¾›ä»¥ä¸‹6ä¸ªæ ¸å¿ƒè¯„ä¼°æŒ‡æ ‡ï¼š

- **MSE (Mean Squared Error)**: å‡æ–¹è¯¯å·®ï¼Œè¶Šå°è¶Šå¥½
- **MAE (Mean Absolute Error)**: å¹³å‡ç»å¯¹è¯¯å·®ï¼Œè¶Šå°è¶Šå¥½
- **RMSE (Root Mean Squared Error)**: å‡æ–¹æ ¹è¯¯å·®ï¼Œè¶Šå°è¶Šå¥½
- **RÂ² (R-squared)**: å†³å®šç³»æ•°ï¼Œè¶Šæ¥è¿‘1è¶Šå¥½ï¼ˆæœ€é‡è¦æŒ‡æ ‡ï¼‰
- **MAPE (%)**: å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®ï¼Œè¶Šå°è¶Šå¥½
- **æ–¹å‘å‡†ç¡®ç‡ (%)**: é¢„æµ‹ä»·æ ¼å˜åŒ–æ–¹å‘çš„å‡†ç¡®æ€§ï¼Œè¶Šé«˜è¶Šå¥½

#### æ¨¡å‹æ€§èƒ½ç­‰çº§åˆ’åˆ†ï¼š
- **ä¼˜ç§€**: RÂ² > 0.8 ä¸” æ–¹å‘å‡†ç¡®ç‡ > 75%
- **è‰¯å¥½**: RÂ² > 0.6 ä¸” æ–¹å‘å‡†ç¡®ç‡ > 65%
- **å¾…æ”¹è¿›**: RÂ² < 0.6 æˆ– æ–¹å‘å‡†ç¡®ç‡ < 65%

## ğŸ”§ é«˜çº§ç”¨æ³•è¯¦è§£

### 1. å•ç‹¬ä½¿ç”¨å„ä¸ªæ¨¡å—
```python
# åªè®­ç»ƒLSTMæ¨¡å‹
system = CarbonPricePredictionSystem()
system.load_data('data.xlsx')
system.preprocess_data()
lstm_model = system.build_lstm_model()

# åªè¿›è¡ŒSHAPåˆ†æ
system.perform_shap_analysis()

# åªç”Ÿæˆå¯è§†åŒ–å›¾è¡¨
system.create_visualizations()
```

### 2. æ‰¹é‡åˆ†æä¸åŒæ•°æ®é›†
```python
datasets = [
    'carbon_data_2020.xlsx', 
    'carbon_data_2021.xlsx', 
    'carbon_data_2022.xlsx'
]

for dataset in datasets:
    print(f"å¤„ç†æ•°æ®é›†: {dataset}")
    system = CarbonPricePredictionSystem()
    system.run_complete_analysis(dataset)
    print(f"{dataset} åˆ†æå®Œæˆ\n")
```

### 3. æ¨¡å‹æ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹
```python
# é«˜æ€§èƒ½é…ç½®ï¼ˆé€‚åˆå¤§æ•°æ®é›†ï¼‰
optimized_config = {
    'target_column': 'carbon_price',
    'sequence_length': 90,           # æ›´é•¿çš„åºåˆ—
    'test_size': 0.15,              # æ›´å°çš„æµ‹è¯•é›†
    'lstm_config': {
        'units': [128, 64, 32],      # æ›´æ·±çš„ç½‘ç»œ
        'dropout': 0.3,              # æ›´å¼ºçš„æ­£åˆ™åŒ–
        'epochs': 200,               # æ›´å¤šè®­ç»ƒè½®æ•°
        'batch_size': 64             # æ›´å¤§çš„æ‰¹å¤„ç†
    },
    'transformer_config': {
        'd_model': 256,              # æ›´å¤§çš„æ¨¡å‹
        'num_heads': 16,
        'num_layers': 6,
        'dff': 1024,
        'dropout': 0.2,
        'epochs': 100
    }
}

system = CarbonPricePredictionSystem(config=optimized_config)
system.run_complete_analysis('large_dataset.xlsx')
```

### 4. è‡ªå®šä¹‰è¾“å‡ºç›®å½•
```python
# æŒ‡å®šè‡ªå®šä¹‰è¾“å‡ºç›®å½•
system = CarbonPricePredictionSystem(output_dir='/path/to/output')
system.run_complete_analysis('data.xlsx')

# æˆ–è€…ä¿®æ”¹å…¨å±€é…ç½®
OUTPUT_DIRS['txt'] = 'my_custom_logs'
OUTPUT_DIRS['excel'] = 'my_custom_reports' 
OUTPUT_DIRS['pic'] = 'my_custom_charts'
```

## ğŸ” SHAPè§£é‡Šæ€§åˆ†ææ·±åº¦æŒ‡å—

### ç†è§£SHAPå€¼çš„å«ä¹‰
- **æ­£å€¼ (+)**ï¼šè¯¥ç‰¹å¾ä½¿é¢„æµ‹å€¼é«˜äºåŸºå‡†å€¼ï¼Œå¯¹ä»·æ ¼ä¸Šæ¶¨æœ‰æ­£é¢å½±å“
- **è´Ÿå€¼ (-)**ï¼šè¯¥ç‰¹å¾ä½¿é¢„æµ‹å€¼ä½äºåŸºå‡†å€¼ï¼Œå¯¹ä»·æ ¼ä¸Šæ¶¨æœ‰è´Ÿé¢å½±å“
- **ç»å¯¹å€¼å¤§å°**ï¼šè¡¨ç¤ºç‰¹å¾å¯¹é¢„æµ‹çš„å½±å“ç¨‹åº¦ï¼Œç»å¯¹å€¼è¶Šå¤§å½±å“è¶Šå¤§

### SHAPå›¾è¡¨è§£è¯»æŒ‡å—
ç³»ç»Ÿç”Ÿæˆä»¥ä¸‹4ç§ä¸»è¦SHAPåˆ†æå›¾è¡¨ï¼š

#### 1. Summary Plotï¼ˆé‡è¦æ€§æ€»ç»“å›¾ï¼‰
- **ç”¨é€”**ï¼šæ˜¾ç¤ºæ‰€æœ‰ç‰¹å¾çš„é‡è¦æ€§å’Œå½±å“æ–¹å‘
- **è¯»æ³•**ï¼š
  - Yè½´ï¼šç‰¹å¾åç§°ï¼ˆæŒ‰é‡è¦æ€§æ’åºï¼‰
  - Xè½´ï¼šSHAPå€¼ï¼ˆå½±å“å¤§å°ï¼‰
  - é¢œè‰²ï¼šç‰¹å¾å€¼é«˜ä½ï¼ˆçº¢è‰²=é«˜å€¼ï¼Œè“è‰²=ä½å€¼ï¼‰

#### 2. Bar Plotï¼ˆé‡è¦æ€§æ¡å½¢å›¾ï¼‰  
- **ç”¨é€”**ï¼šæ˜¾ç¤ºç‰¹å¾é‡è¦æ€§æ’åºï¼Œä¸åŒºåˆ†æ­£è´Ÿå½±å“
- **è¯»æ³•**ï¼šæ¡å½¢è¶Šé•¿ï¼Œè¯¥ç‰¹å¾å¯¹é¢„æµ‹çš„å½±å“è¶Šå¤§

#### 3. Dependence Plotï¼ˆä¾èµ–å…³ç³»å›¾ï¼‰
- **ç”¨é€”**ï¼šæ˜¾ç¤ºå•ä¸ªç‰¹å¾å¦‚ä½•å½±å“é¢„æµ‹
- **è¯»æ³•**ï¼š
  - Xè½´ï¼šç‰¹å¾å€¼
  - Yè½´ï¼šè¯¥ç‰¹å¾çš„SHAPå€¼
  - é¢œè‰²ï¼šå¦ä¸€ä¸ªç›¸å…³ç‰¹å¾çš„å€¼

#### 4. Training Historyï¼ˆè®­ç»ƒå†å²å›¾ï¼‰
- **ç”¨é€”**ï¼šæ˜¾ç¤ºLSTMå’ŒTransformeræ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹
- **åŒ…å«**ï¼šæŸå¤±å‡½æ•°å’ŒMAEæŒ‡æ ‡çš„è®­ç»ƒ/éªŒè¯æ›²çº¿

### å®é™…åº”ç”¨å»ºè®®

#### ç‰¹å¾é‡è¦æ€§åˆ†æ
1. **è¯†åˆ«å…³é”®å½±å“å› å­**ï¼šæŸ¥çœ‹å‰5-10ä¸ªé‡è¦ç‰¹å¾
2. **ç›‘æ§é‡è¦ç‰¹å¾å˜åŒ–**ï¼šå®šæœŸæ£€æŸ¥è¿™äº›ç‰¹å¾çš„æ•°æ®è´¨é‡
3. **éªŒè¯æ¨¡å‹é€»è¾‘**ï¼šç¡®ä¿é‡è¦ç‰¹å¾ç¬¦åˆé¢†åŸŸçŸ¥è¯†

#### å†³ç­–æ”¯æŒ
1. **æ”¿ç­–åˆ¶å®šä¾æ®**ï¼šä½¿ç”¨SHAPç»“æœè¯æ˜æ”¿ç­–å½±å“
2. **é£é™©ç®¡ç†**ï¼šè¯†åˆ«å¯¹ä»·æ ¼å½±å“æœ€å¤§çš„å› å­
3. **å¸‚åœºåˆ†æ**ï¼šç†è§£ä¸åŒå› å­å¯¹ç¢³ä»·çš„å½±å“æœºåˆ¶

## âš ï¸ æ³¨æ„äº‹é¡¹å’Œæœ€ä½³å®è·µ

### ğŸ“Š æ•°æ®è´¨é‡è¦æ±‚
- **å®Œæ•´æ€§**ï¼šç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œå‡†ç¡®æ€§ï¼Œç¼ºå¤±å€¼ < 5%
- **å¼‚å¸¸å€¼å¤„ç†**ï¼šåŠæ—¶è¯†åˆ«å’Œå¤„ç†æ•°æ®ä¸­çš„å¼‚å¸¸å€¼
- **æ—¶é—´è¿ç»­æ€§**ï¼šä¿æŒæ•°æ®çš„æ—¶é—´è¿ç»­æ€§ï¼Œé¿å…å¤§é‡ç©ºç¼º
- **ç‰¹å¾ç›¸å…³æ€§**ï¼šé€‰æ‹©ä¸ç¢³ä»·ç›¸å…³æ€§å¼ºçš„ç‰¹å¾

### ğŸ’» æ¨¡å‹æ€§èƒ½æŒ‡å¯¼
- **ä¼˜ç§€æ¨¡å‹**: RÂ² > 0.8 ä¸” MAPE < 10% ä¸” æ–¹å‘å‡†ç¡®ç‡ > 75%
- **è‰¯å¥½æ¨¡å‹**: RÂ² > 0.6 ä¸” MAPE < 15% ä¸” æ–¹å‘å‡†ç¡®ç‡ > 65%
- **éœ€è¦æ”¹è¿›**: RÂ² < 0.6 æˆ– MAPE > 20% æˆ– æ–¹å‘å‡†ç¡®ç‡ < 60%

### ğŸ’» è®¡ç®—èµ„æºå»ºè®®
- **å†…å­˜è¦æ±‚**ï¼šå»ºè®® 16GB ä»¥ä¸Šï¼ŒLSTMå’ŒTransformeræ¨¡å‹éœ€è¦è¾ƒå¤šå†…å­˜
- **GPUåŠ é€Ÿ**ï¼šå»ºè®®åœ¨GPUç¯å¢ƒä¸­è¿è¡Œæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå¯æ˜¾è‘—æé«˜è®­ç»ƒé€Ÿåº¦
- **è®­ç»ƒæ—¶é—´**ï¼šæ•´ä¸ªåˆ†ææµç¨‹å¯èƒ½éœ€è¦ 20-60 åˆ†é’Ÿï¼Œå–å†³äºæ•°æ®é‡å’Œé…ç½®
- **SHAPè®¡ç®—**ï¼šSHAPåˆ†æå¯èƒ½æ¯”è¾ƒè€—æ—¶ï¼Œå¤§æ•°æ®é›†å»ºè®®ä½¿ç”¨é‡‡æ ·

### ğŸ”„ æ¨¡å‹ç»´æŠ¤å’Œæ›´æ–°
- **å®šæœŸé‡è®­**ï¼šå»ºè®®æ¯æœˆæˆ–æ¯å­£åº¦é‡æ–°è®­ç»ƒæ¨¡å‹
- **æ•°æ®æ›´æ–°**ï¼šåŠæ—¶çº³å…¥æ–°çš„å¸‚åœºæ•°æ®å’Œæ”¿ç­–å˜åŒ–
- **æ¨¡å‹éªŒè¯**ï¼šå®šæœŸéªŒè¯æ¨¡å‹åœ¨æ–°æ•°æ®ä¸Šçš„è¡¨ç°
- **å‚æ•°è°ƒä¼˜**ï¼šæ ¹æ®å®é™…è¡¨ç°è°ƒæ•´æ¨¡å‹å‚æ•°

### ğŸš« é£é™©æç¤º
- **ä¸åšæŠ•èµ„å»ºè®®**ï¼šæ¨¡å‹é¢„æµ‹ä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®
- **æ”¿ç­–é£é™©**ï¼šç¢³å¸‚åœºå—æ”¿ç­–å½±å“è¾ƒå¤§ï¼Œå­˜åœ¨ä¸ç¡®å®šæ€§
- **é»‘å¤©é¹…äº‹ä»¶**ï¼šæ¨¡å‹æ— æ³•é¢„æµ‹çªå‘æ€§é‡å¤§äº‹ä»¶
- **æ¨¡å‹å±€é™æ€§**ï¼šæ¨¡å‹åŸºäºå†å²æ•°æ®ï¼Œå¯¹æœªæ¥æ–°æƒ…å†µé€‚åº”æ€§æœ‰é™

### ğŸ“ˆ æœ€ä½³å®è·µå»ºè®®
1. **å¤šæ¨¡å‹é›†æˆ**ï¼šç»“åˆå¤šä¸ªæ¨¡å‹çš„é¢„æµ‹ç»“æœï¼Œæé«˜é¢„æµ‹ç¨³å®šæ€§
2. **é¢†åŸŸçŸ¥è¯†ç»“åˆ**ï¼šç»“åˆç¢³å¸‚åœºä¸“ä¸šçŸ¥è¯†ç†è§£æ¨¡å‹è¾“å‡º
3. **å®šæœŸå›æµ‹**ï¼šå®šæœŸè¯„ä¼°æ¨¡å‹é¢„æµ‹å‡†ç¡®æ€§ï¼ŒåŠæ—¶è°ƒæ•´
4. **å¤šæ—¶é—´å°ºåº¦**ï¼šç»“åˆçŸ­æœŸã€ä¸­æœŸã€é•¿æœŸä¸åŒé¢„æµ‹ç»“æœ
5. **é€æ˜åŒ–å†³ç­–**ï¼šå§‹ç»ˆä½¿ç”¨SHAPåˆ†æç†è§£æ¨¡å‹å†³ç­–è¿‡ç¨‹

## ğŸ” æ•…éšœæ’é™¤ï¼ˆæ–°æ‰‹å¿…å¤‡ï¼‰

### ğŸš¨ å®‰è£…é—®é¢˜è§£å†³

#### é—®é¢˜1ï¼šå¯¼å…¥é”™è¯¯
Error: `ModuleNotFoundError: No module named 'xxx'`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ–¹æ³•1ï¼šç”¨pipé‡æ–°å®‰è£…
pip install ç¼ºå¤±çš„åº“å

# æ–¹æ³•2ï¼šç”¨condaå®‰è£…ï¼ˆå¦‚æœä½¿ç”¨Anacondaï¼‰
conda install -c conda-forge ç¼ºå¤±çš„åº“å

# æ–¹æ³•3ï¼šå‡çº§pipåé‡æ–°å®‰è£…
pip install --upgrade pip
pip install ç¼ºå¤±çš„åº“å
```

#### é—®é¢˜2ï¼šXGBooståœ¨macOSä¸Šçš„é”™è¯¯
Error: `OSError: dlopen(libxgboost.dylib): Library not loaded`

**macOSå¿…é¡»å®‰è£…OpenMP**ï¼š
```bash
# å®‰è£…Homebrewï¼ˆå¦‚æœæ²¡æœ‰ï¼‰
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# å®‰è£…OpenMP
brew install libomp

# é‡æ–°å®‰è£…XGBoost
pip uninstall xgboost
pip install xgboost
```

#### é—®é¢˜3ï¼šTensorFlowå®‰è£…é—®é¢˜
**å¯¹äºM1/M2 Macç”¨æˆ·**ï¼š
```bash
# ä½¿ç”¨Appleä¼˜åŒ–ç‰ˆæœ¬
pip install tensorflow-macos
pip install tensorflow-metal  # GPUåŠ é€Ÿï¼ˆå¯é€‰ï¼‰
```

**å¯¹äºè€ç‰ˆCPU**ï¼š
```bash
# å®‰è£…CPUç‰ˆæœ¬
pip install tensorflow-cpu
```

#### é—®é¢˜4ï¼šæƒé™é—®é¢˜ï¼ˆWindowsï¼‰
å¦‚æœå‡ºç°æƒé™é”™è¯¯ï¼Œä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡ŒCMDæˆ–PowerShell

### ğŸ“ æ•°æ®ç›¸å…³é—®é¢˜

#### é—®é¢˜1ï¼šæ–‡ä»¶æ‰¾ä¸åˆ°
Error: `FileNotFoundError: [Errno 2] No such file or directory`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# æ£€æŸ¥å½“å‰ç›®å½•
import os
print("å½“å‰ç›®å½•ï¼š", os.getcwd())
print("ç›®å½•ä¸­çš„æ–‡ä»¶ï¼š", os.listdir('.'))

# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
file_path = 'æ‚¨çš„æ•°æ®æ–‡ä»¶.xlsx'
if os.path.exists(file_path):
    print(f"âœ… æ–‡ä»¶å­˜åœ¨: {file_path}")
else:
    print(f"âŒ æ–‡ä»¶ä¸å­˜åœ¨: {file_path}")
    print("è¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶å")
```

#### é—®é¢˜2ï¼šExcelæ–‡ä»¶è¯»å–é”™è¯¯
Error: `PermissionError: [Errno 13] Permission denied`

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. å…³é—­Excelç¨‹åºï¼ˆæ–‡ä»¶å¯èƒ½æ­£åœ¨è¢«ä½¿ç”¨ï¼‰
2. æ£€æŸ¥æ–‡ä»¶æƒé™ï¼Œç¡®ä¿å¯è¯»å–
3. å°†æ–‡ä»¶å¤åˆ¶åˆ°å…¶ä»–ä½ç½®å†å°è¯•

#### é—®é¢˜3ï¼šæ•°æ®æ ¼å¼é”™è¯¯
Error: `ValueError: could not convert string to float`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# æ£€æŸ¥æ•°æ®ç±»å‹
df = pd.read_excel('æ‚¨çš„æ•°æ®æ–‡ä»¶.xlsx')
print(df.dtypes)
print(df.head())

# æŸ¥æ‰¾éæ•°å€¼æ•°æ®
for col in df.columns:
    if df[col].dtype == 'object':
        print(f"åˆ— {col} åŒ…å«éæ•°å€¼æ•°æ®:")
        print(df[col].unique())
```

### ğŸ”§ æ€§èƒ½é—®é¢˜è§£å†³

#### é—®é¢˜1ï¼šå†…å­˜ä¸è¶³
Error: `MemoryError`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# å‡å°æ‰¹å¤„ç†å¤§å°å’Œåºåˆ—é•¿åº¦
config = {
    'sequence_length': 30,  # é»˜è®¤æ˜¯60
    'lstm_config': {
        'batch_size': 16,   # é»˜è®¤æ˜¯32
        'units': [32, 16]   # é»˜è®¤æ˜¯[64, 32]
    }
}
system = CarbonPricePredictionSystem(config=config)
```

#### é—®é¢˜2ï¼šè®­ç»ƒæ—¶é—´è¿‡é•¿

**è§£å†³æ–¹æ¡ˆ**ï¼š
```python
# å‡å°‘è®­ç»ƒè½®æ•°
config = {
    'lstm_config': {
        'epochs': 50      # é»˜è®¤æ˜¯100
    },
    'transformer_config': {
        'epochs': 25      # é»˜è®¤æ˜¯50
    }
}
system = CarbonPricePredictionSystem(config=config)
```

#### é—®é¢˜3ï¼šGPUä¸å¯ç”¨
å¦‚æœGPUä¸å¯ç”¨ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨CPUï¼Œä½†é€Ÿåº¦ä¼šè¾ƒæ…¢ã€‚

**æ£€æŸ¥GPUçŠ¶æ€**ï¼š
```python
import tensorflow as tf
print("GPUå¯ç”¨:", tf.config.list_physical_devices('GPU'))
print("TensorFlowç‰ˆæœ¬:", tf.__version__)
```

### ğŸ“Š æ¨¡å‹æ€§èƒ½é—®é¢˜

#### é—®é¢˜1ï¼šé¢„æµ‹ç²¾åº¦å¤ªä½
**RÂ² < 0.5 æ—¶çš„æ”¹è¿›å»ºè®®**ï¼š

1. **æ•°æ®è´¨é‡é—®é¢˜**ï¼š
   - æ£€æŸ¥æ•°æ®å®Œæ•´æ€§
   - å¤„ç†å¼‚å¸¸å€¼
   - å¢åŠ æ•°æ®é‡

2. **ç‰¹å¾å·¥ç¨‹**ï¼š
   - æ·»åŠ æ›´å¤šç›¸å…³ç‰¹å¾
   - æ£€æŸ¥ç‰¹å¾ä¸ç›®æ ‡çš„ç›¸å…³æ€§
   - è€ƒè™‘ç‰¹å¾å˜æ¢

3. **æ¨¡å‹è°ƒä¼˜**ï¼š
```python
# å¢åŠ æ¨¡å‹å¤æ‚åº¦
config = {
    'sequence_length': 90,
    'lstm_config': {
        'units': [128, 64, 32],
        'epochs': 200
    }
}
```

#### é—®é¢˜2ï¼šè¿‡æ‹Ÿåˆé—®é¢˜
**è®­ç»ƒé›†è¡¨ç°å¥½ï¼Œæµ‹è¯•é›†è¡¨ç°å·®**ï¼š

```python
# å¢åŠ æ­£åˆ™åŒ–
config = {
    'lstm_config': {
        'dropout': 0.3,    # é»˜è®¤æ˜¯0.2
        'epochs': 50       # å‡å°‘è®­ç»ƒè½®æ•°
    }
}
```

### ğŸ“ å¸¸è§é—®é¢˜å¿«é€Ÿå‚è€ƒ

| é—®é¢˜æè¿° | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|---------|----------|
| å¯¼å…¥é”™è¯¯ | ç¼ºå°‘åº“ | é‡æ–°å®‰è£…å¯¹åº”åº“ |
| æ–‡ä»¶æ‰¾ä¸åˆ° | è·¯å¾„é”™è¯¯ | æ£€æŸ¥æ–‡ä»¶è·¯å¾„ |
| æ•°æ®æ ¼å¼é”™è¯¯ | åˆ—åæˆ–æ ¼å¼é—®é¢˜ | æ£€æŸ¥Excelæ ¼å¼ |
| å†…å­˜ä¸è¶³ | æ•°æ®å¤ªå¤§ | å‡å°æ‰¹å¤§å° |
| è®­ç»ƒè¿‡æ…¢ | å‚æ•°è¿‡å¤§ | å‡å°‘è½®æ•°/å±‚æ•° |
| ç²¾åº¦å¤ªä½ | æ•°æ®è´¨é‡é—®é¢˜ | æ”¹å–„æ•°æ®/ç‰¹å¾ |
| macOS XGBoosté”™è¯¯ | ç¼ºå°‘OpenMP | å®‰è£…libomp |

### ğŸ“ è¾“å‡ºæ–‡ä»¶ç»“æ„ç¤ºä¾‹

è¿è¡ŒæˆåŠŸåï¼Œé¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```
ğŸ“ AI/
â”œâ”€â”€ ğŸ carbon_price_prediction.py
â”œâ”€â”€ ğŸ“„ README.md
â”œâ”€â”€ ğŸ“„ ç¢³ä»·æ ¼é¢„æµ‹ç³»ç»Ÿä½¿ç”¨æŒ‡å—.md
â”œâ”€â”€ ğŸ“ model_knowledge/
â”œâ”€â”€ ğŸ“ carbon_prediction_log_txt/          # æ–‡æœ¬æŠ¥å‘Šç›®å½•
â”‚   â”œâ”€â”€ ğŸ“„ carbon_price_prediction_20241221_143025_detailed_report.txt
â”‚   â””â”€â”€ ğŸ“„ carbon_price_prediction_20241221_143025_runtime_log.txt
â”œâ”€â”€ ğŸ“ carbon_prediction_results_excel/   # ExcelæŠ¥å‘Šç›®å½•
â”‚   â””â”€â”€ ğŸ“„ carbon_price_prediction_20241221_143025_report.xlsx
â””â”€â”€ ğŸ“ carbon_prediction_results_pic/     # å›¾è¡¨ç›®å½•
    â”œâ”€â”€ ğŸ–¼ï¸ carbon_price_prediction_20241221_143025_model_performance_comparison.png
    â”œâ”€â”€ ğŸ–¼ï¸ carbon_price_prediction_20241221_143025_prediction_comparison.png
    â”œâ”€â”€ ğŸ–¼ï¸ carbon_price_prediction_20241221_143025_shap_summary_plot.png
    â”œâ”€â”€ ğŸ–¼ï¸ carbon_price_prediction_20241221_143025_shap_bar_plot.png
    â”œâ”€â”€ ğŸ–¼ï¸ carbon_price_prediction_20241221_143025_shap_dependence_plots.png
    â””â”€â”€ ğŸ–¼ï¸ carbon_price_prediction_20241221_143025_training_history.png
```

### ğŸš€ å®Œæ•´è¿è¡Œç¤ºä¾‹

ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¿è¡Œç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨è‡ªå·±çš„æ•°æ®ï¼š

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ç¢³ä»·æ ¼é¢„æµ‹ç³»ç»Ÿ - å®Œæ•´è¿è¡Œç¤ºä¾‹
"""

import os
import sys
from carbon_price_prediction import CarbonPricePredictionSystem

def main():
    """ä¸»è¿è¡Œå‡½æ•°"""
    print("ğŸŒ" + "="*60)
    print(" " * 20 + "ç¢³ä»·æ ¼é¢„æµ‹ç³»ç»Ÿ")
    print(" " * 15 + "LSTM + Transformer + SHAP åˆ†æ")
    print("="*60 + " ğŸŒ")
    
    # æ­¥éª¤1ï¼šè®¾ç½®ä½ çš„æ•°æ®æ–‡ä»¶è·¯å¾„
    data_file = 'your_carbon_data.xlsx'  # ä¿®æ”¹ä¸ºä½ çš„æ•°æ®æ–‡ä»¶
    
    # æ­¥éª¤2ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    if not os.path.exists(data_file):
        print(f"âš ï¸ æœªæ‰¾åˆ°æ•°æ®æ–‡ä»¶: {data_file}")
        print("ğŸ“¦ ä½¿ç”¨ç¤ºä¾‹æ•°æ®è¿›è¡Œæ¼”ç¤º...")
        data_file = None  # ä½¿ç”¨é»˜è®¤ç¤ºä¾‹æ•°æ®
    
    # æ­¥éª¤3ï¼šé…ç½®æ¨¡å‹å‚æ•°ï¼ˆå¯é€‰ï¼‰
    custom_config = {
        'target_column': 'carbon_price',  # ä¿®æ”¹ä¸ºä½ çš„ç¢³ä»·æ ¼åˆ—å
        'sequence_length': 60,            # æ—¶é—´åºåˆ—é•¿åº¦
        'test_size': 0.2,                # æµ‹è¯•é›†æ¯”ä¾‹
        'lstm_config': {
            'units': [64, 32],            # LSTMç½‘ç»œç»“æ„
            'epochs': 100,                # è®­ç»ƒè½®æ•°
            'batch_size': 32
        },
        'transformer_config': {
            'd_model': 128,
            'num_heads': 8,
            'epochs': 50
        }
    }
    
    try:
        # æ­¥éª¤4ï¼šåˆ›å»ºç³»ç»Ÿå®ä¾‹
        print("ğŸ¤– åˆå§‹åŒ–é¢„æµ‹ç³»ç»Ÿ...")
        system = CarbonPricePredictionSystem(config=custom_config)
        
        # æ­¥éª¤5ï¼šè¿è¡Œå®Œæ•´åˆ†æ
        print("ğŸš€ å¼€å§‹å®Œæ•´åˆ†ææµç¨‹...")
        success = system.run_complete_analysis(data_file)
        
        if success:
            print("\nğŸ‰ åˆ†æå®Œæˆï¼")
            print("ğŸ“ ç”Ÿæˆæ–‡ä»¶:")
            print("   â€¢ ExcelæŠ¥å‘Š: carbon_prediction_results_excel/")
            print("   â€¢ æ–‡æœ¬æŠ¥å‘Š: carbon_prediction_log_txt/")
            print("   â€¢ å¯è§†åŒ–å›¾è¡¨: carbon_prediction_results_pic/")
            
            # æ‰“å°ç®€è¦ç»“æœ
            if hasattr(system, 'predictions'):
                best_model = max(system.predictions.keys(), 
                               key=lambda x: system.predictions[x]['RÂ²'])
                best_r2 = system.predictions[best_model]['RÂ²']
                print(f"\nğŸ† æœ€ä½³æ¨¡å‹: {best_model} (RÂ² = {best_r2:.4f})")
        else:
            print("\nâš ï¸ åˆ†æè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯")
            
    except Exception as e:
        print(f"\nâŒ è¿è¡Œé”™è¯¯: {str(e)}")
        import traceback
        traceback.print_exc()

if __name__ == "__main__":
    main()
```

### ğŸ” æ•…éšœæ’é™¤å¿«é€Ÿæ£€æŸ¥åˆ—è¡¨

1. **æ£€æŸ¥ç¯å¢ƒ**ï¼š
   - Pythonç‰ˆæœ¬
   - å·²å®‰è£…çš„åº“åŠç‰ˆæœ¬
   - æ“ä½œç³»ç»Ÿç‰ˆæœ¬

2. **æ£€æŸ¥æ•°æ®**ï¼š
   - æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®
   - æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
   - æ•°æ®è´¨é‡æ˜¯å¦ç¬¦åˆè¦æ±‚

3. **æ£€æŸ¥é…ç½®**ï¼š
   - ç³»ç»Ÿé…ç½®æ˜¯å¦åˆç†
   - å†…å­˜å’Œè®¡ç®—èµ„æºæ˜¯å¦è¶³å¤Ÿ

4. **æŸ¥çœ‹é”™è¯¯ä¿¡æ¯**ï¼š
   - ä¿å­˜å®Œæ•´çš„é”™è¯¯æ—¥å¿—
   - æ³¨æ„é”™è¯¯ç±»å‹å’Œå…³é”®ä¿¡æ¯

## ğŸ“š å‚è€ƒèµ„æ–™

### ç›¸å…³è®ºæ–‡å’Œæ–‡æ¡£
- LSTM: "Long Short-Term Memory" by Hochreiter & Schmidhuber
- Transformer: "Attention Is All You Need" by Vaswani et al.
- SHAP: "A Unified Approach to Interpreting Model Predictions" by Lundberg & Lee

### æ‰©å±•é˜…è¯»
- æ—¶é—´åºåˆ—é¢„æµ‹æœ€ä½³å®è·µ
- é‡‘èæœºå™¨å­¦ä¹ åº”ç”¨
- å¯è§£é‡ŠAIåœ¨ç›‘ç®¡ä¸­çš„åº”ç”¨

---

## ğŸŒ† æ–°æ‰‹å®Œæ•´æ“ä½œæµç¨‹æ€»ç»“

### ğŸ› ï¸ ç¯å¢ƒå‡†å¤‡ï¼ˆç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼‰

1. **æ£€æŸ¥Pythonç‰ˆæœ¬**ï¼š
   ```bash
   python --version  # åº”è¯¥æ˜¯3.7+
   ```

2. **å®‰è£…å¿…éœ€åº“**ï¼ˆæ ¹æ®æ‚¨çš„æ“ä½œç³»ç»Ÿï¼‰ï¼š
   
   **Windowsç”¨æˆ·**ï¼š
   ```bash
   pip install numpy pandas matplotlib seaborn scikit-learn tensorflow xgboost lightgbm shap openpyxl
   ```
   
   **macOSç”¨æˆ·**ï¼š
   ```bash
   # å…ˆå®‰è£…OpenMP
   brew install libomp
   # å†å®‰è£…Pythonåº“
   pip install numpy pandas matplotlib seaborn scikit-learn tensorflow xgboost lightgbm shap openpyxl
   ```
   
   **Linuxç”¨æˆ·**ï¼š
   ```bash
   sudo apt update && sudo apt install build-essential python3-dev libomp-dev
   pip install numpy pandas matplotlib seaborn scikit-learn tensorflow xgboost lightgbm shap openpyxl
   ```

3. **éªŒè¯å®‰è£…**ï¼š
   ```python
   # è¿è¡Œè¿™æ®µä»£ç æ£€æŸ¥
   import numpy, pandas, matplotlib, seaborn, sklearn, tensorflow, xgboost, lightgbm, shap, openpyxl
   print("âœ… æ‰€æœ‰åº“å®‰è£…æˆåŠŸï¼")
   ```

### ğŸ“Š æ•°æ®å‡†å¤‡

1. **åˆ›å»ºExcelæ–‡ä»¶**ï¼š
   - æ‰“å¼€Excelï¼Œåˆ›å»ºæ–°å·¥ä½œè¡¨
   - A1: "æ—¥æœŸ", B1: "carbon_price", C1åŠä»¥å: å…¶ä»–å½±å“å› å­
   - ä»ç¬¬2è¡Œå¼€å§‹å¡«å…¥æ•°æ®
   - ä¿å­˜ä¸º `.xlsx` æ ¼å¼

2. **æ•°æ®æ ¼å¼æ£€æŸ¥**ï¼š
   - æ—¥æœŸæ ¼å¼ï¼šYYYY-MM-DD
   - æ•°å€¼åˆ—åªåŒ…å«æ•°å­—
   - æ— ç©ºç™½è¡Œå’Œåˆå¹¶å•å…ƒæ ¼

### ğŸš€ è¿è¡Œåˆ†æï¼ˆæ–°æ‰‹ç‰ˆï¼‰

```python
# æ–°æ‰‹å®Œæ•´ä»£ç æ¨¡æ¿
import os
from carbon_price_prediction import CarbonPricePredictionSystem

# 1. æ£€æŸ¥ç¯å¢ƒ
print("ğŸ“ æ­¥éª¤1: æ£€æŸ¥ç¯å¢ƒ")
print(f"å½“å‰ç›®å½•: {os.getcwd()}")
print(f"ç›®å½•æ–‡ä»¶: {os.listdir('.')}")

# 2. è®¾ç½®æ•°æ®æ–‡ä»¶è·¯å¾„
print("\nğŸ“Š æ­¥éª¤2: è®¾ç½®æ•°æ®æ–‡ä»¶")
data_file = "æ‚¨çš„æ•°æ®æ–‡ä»¶.xlsx"  # è¯·ä¿®æ”¹ä¸ºæ‚¨çš„å®é™…æ–‡ä»¶å

# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
if not os.path.exists(data_file):
    print(f"âŒ é”™è¯¯: æ‰¾ä¸åˆ°æ–‡ä»¶ {data_file}")
    print("è¯·æ£€æŸ¥:")
    print("- æ–‡ä»¶åæ˜¯å¦æ­£ç¡®")
    print("- æ–‡ä»¶æ˜¯å¦åœ¨å½“å‰ç›®å½•")
    print("- è·¯å¾„æ˜¯å¦ä½¿ç”¨å®Œæ•´è·¯å¾„")
    exit()
else:
    print(f"âœ… æ–‡ä»¶å­˜åœ¨: {data_file}")

# 3. åˆ›å»ºç³»ç»Ÿå®ä¾‹
print("\nğŸ¤– æ­¥éª¤3: åˆ›å»ºé¢„æµ‹ç³»ç»Ÿ")
try:
    system = CarbonPricePredictionSystem()
    print("âœ… ç³»ç»Ÿåˆ›å»ºæˆåŠŸ")
except Exception as e:
    print(f"âŒ ç³»ç»Ÿåˆ›å»ºå¤±è´¥: {e}")
    exit()

# 4. åŠ è½½æ•°æ®
print("\nğŸ“Š æ­¥éª¤4: åŠ è½½æ•°æ®")
try:
    system.load_data(data_file)
    print("âœ… æ•°æ®åŠ è½½æˆåŠŸ")
except Exception as e:
    print(f"âŒ æ•°æ®åŠ è½½å¤±è´¥: {e}")
    print("è¯·æ£€æŸ¥:")
    print("- Excelæ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®")
    print("- æ•°æ®åˆ—åæ˜¯å¦åŒ…å«'carbon_price'")
    print("- æ•°æ®ä¸­æ˜¯å¦æœ‰éæ•°å€¼å†…å®¹")
    exit()

# 5. è¿è¡Œå®Œæ•´åˆ†æ
print("\nğŸš€ æ­¥éª¤5: å¼€å§‹åˆ†æå¤„ç†")
print("è¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿåˆ°å‡ ååˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…...")

try:
    print("â–¶ï¸ æ­¥éª¤5.1: æ•°æ®é¢„å¤„ç†...")
    system.preprocess_data()
    
    print("â–¶ï¸ æ­¥éª¤5.2: è®­ç»ƒæ¨¡å‹...")
    system.train_models()
    
    print("â–¶ï¸ æ­¥éª¤5.3: è¯„ä¼°æ¨¡å‹...")
    system.evaluate_models()
    
    print("â–¶ï¸ æ­¥éª¤5.4: SHAPåˆ†æ...")
    system.perform_shap_analysis()
    
    print("â–¶ï¸ æ­¥éª¤5.5: ç”Ÿæˆå¯è§†åŒ–...")
    system.create_visualizations()
    
    print("â–¶ï¸ æ­¥éª¤5.6: ç”ŸæˆæŠ¥å‘Š...")
    system.generate_report()
    
    print("\nğŸ‰ åˆ†æå®Œæˆï¼")
    
except Exception as e:
    print(f"\nâŒ åˆ†æè¿‡ç¨‹ä¸­å‡ºé”™: {e}")
    print("è¯·æ£€æŸ¥ä¸Šé¢çš„æ•…éšœæ’é™¤æŒ‡å—")
    exit()

# 6. æ£€æŸ¥ç»“æœ
print("\nğŸ“ æ­¥éª¤6: æ£€æŸ¥ç”Ÿæˆçš„æ–‡ä»¶")
result_files = [
    "carbon_prediction_report.xlsx",
    "carbon_prediction_results/"
]

for file_path in result_files:
    if os.path.exists(file_path):
        print(f"âœ… ç”ŸæˆæˆåŠŸ: {file_path}")
    else:
        print(f"âš ï¸ æœªæ‰¾åˆ°: {file_path}")

print("\nğŸ† å…¨éƒ¨å®Œæˆï¼è¯·æŸ¥çœ‹ç”Ÿæˆçš„æŠ¥å‘Šå’Œå›¾è¡¨")
```

### ğŸ“ æ–°æ‰‹æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡ä½¿ç”¨**ï¼š
   - ä¸€å®šè¦å…ˆè¿è¡Œç¯å¢ƒéªŒè¯ä»£ç 
   - å»ºè®®å…ˆç”¨ç¤ºä¾‹æ•°æ®æµ‹è¯•
   - ç¡®ä¿ç”µè„‘æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼ˆè‡³å°‘4GBï¼‰

2. **æ–‡ä»¶è·¯å¾„**ï¼š
   - Windows: ä½¿ç”¨ `r'C:\path\to\file.xlsx'` æˆ– `'C:/path/to/file.xlsx'`
   - Mac/Linux: ä½¿ç”¨ `'/path/to/file.xlsx'`
   - é¿å…ä¸­æ–‡è·¯å¾„å’Œç‰¹æ®Šå­—ç¬¦

3. **è¿è¡Œæ—¶é—´**ï¼š
   - æ•´ä¸ªåˆ†æå¯èƒ½éœ€è¦10-60åˆ†é’Ÿ
   - å¯ä»¥å…ˆç”¨å°æ•°æ®é›†æµ‹è¯•
   - ä¸è¦ä¸­é€”å…³é—­ç¨‹åº

4. **é‡åˆ°é—®é¢˜**ï¼š
   - ä¿å­˜å®Œæ•´çš„é”™è¯¯ä¿¡æ¯
   - å‚è€ƒä¸Šé¢çš„æ•…éšœæ’é™¤æŒ‡å—
   - æ£€æŸ¥æ•°æ®æ ¼å¼å’Œè·¯å¾„


---

**ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025å¹´9æœˆ  
**é€‚ç”¨äº**: carbon_price_prediction.py v3.0+
**æ–‡æ¡£çŠ¶æ€**: æ­£å¼ç‰ˆæœ¬ï¼Œä¸ä»£ç å®ç°å®Œå…¨åŒæ­¥

