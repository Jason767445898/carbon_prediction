

============================================================
第四轮参数调优开始
============================================================
开始时间: 2025-10-14 23:57:04

优化策略:
- LSTM: 基于第二轮成功经验(batch_size=8)，延长训练+微调dropout
- Transformer: 激进简化(d_model=16-48, 1-2层)+高dropout(0.4-0.6)

============================================================

调优时间: 2025-10-14 23:58:05
配置参数:
  LSTM配置: {'units': [64, 32], 'dropout': 0.2, 'epochs': 150, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 1, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 4690.6465
    MAE: 51.2636
    RMSE: 68.4883
    R²: 0.5632
    MAPE: 5.2595
    Direction_Accuracy: 42.3280
  transformer:
    MSE: 55007.0625
    MAE: 200.9396
    RMSE: 234.5358
    R²: -4.1228
    MAPE: 21.3265
    Direction_Accuracy: 40.2116
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 1: 基线强化-延长训练
--------------------------------------------------
调优时间: 2025-10-14 23:59:22
配置参数:
  LSTM配置: {'units': [64, 32], 'dropout': 0.15, 'epochs': 150, 'batch_size': 8}
  Transformer配置: {'d_model': 24, 'num_heads': 2, 'num_layers': 1, 'dff': 96, 'dropout': 0.5, 'epochs': 120, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 2035.2495
    MAE: 33.0732
    RMSE: 45.1137
    R²: 0.8105
    MAPE: 3.4173
    Direction_Accuracy: 40.7407
  transformer:
    MSE: 3352.5420
    MAE: 44.1408
    RMSE: 57.9011
    R²: 0.6878
    MAPE: 4.6701
    Direction_Accuracy: 50.7937
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 2: 基线强化-降低dropout
--------------------------------------------------
调优时间: 2025-10-15 00:01:17
配置参数:
  LSTM配置: {'units': [64, 32], 'dropout': 0.1, 'epochs': 150, 'batch_size': 8}
  Transformer配置: {'d_model': 32, 'num_heads': 2, 'num_layers': 1, 'dff': 128, 'dropout': 0.5, 'epochs': 150, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 2386.2947
    MAE: 39.1113
    RMSE: 48.8497
    R²: 0.7778
    MAPE: 4.1132
    Direction_Accuracy: 46.5608
  transformer:
    MSE: 3111.3364
    MAE: 39.5927
    RMSE: 55.7794
    R²: 0.7102
    MAPE: 4.3164
    Direction_Accuracy: 49.2063
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 3: 基线强化-最小dropout
--------------------------------------------------
调优时间: 2025-10-15 00:02:50
配置参数:
  LSTM配置: {'units': [96, 48], 'dropout': 0.2, 'epochs': 120, 'batch_size': 8}
  Transformer配置: {'d_model': 32, 'num_heads': 4, 'num_layers': 1, 'dff': 128, 'dropout': 0.5, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 1789.8969
    MAE: 31.3594
    RMSE: 42.3072
    R²: 0.8333
    MAPE: 3.2659
    Direction_Accuracy: 43.3862
  transformer:
    MSE: 6273.7163
    MAE: 59.6583
    RMSE: 79.2068
    R²: 0.4157
    MAPE: 6.4494
    Direction_Accuracy: 48.1481
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 4: 网络容量-增加宽度
--------------------------------------------------
调优时间: 2025-10-15 00:04:52
配置参数:
  LSTM配置: {'units': [96, 64, 32], 'dropout': 0.2, 'epochs': 120, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 1973.6567
    MAE: 33.4170
    RMSE: 44.4259
    R²: 0.8162
    MAPE: 3.4642
    Direction_Accuracy: 46.5608
  transformer:
    MSE: 2282.8743
    MAE: 35.2319
    RMSE: 47.7794
    R²: 0.7874
    MAPE: 3.5694
    Direction_Accuracy: 55.5556
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 5: 网络容量-增加深度
--------------------------------------------------
调优时间: 2025-10-15 00:06:06
配置参数:
  LSTM配置: {'units': [96, 48], 'dropout': 0.15, 'epochs': 150, 'batch_size': 8}
  Transformer配置: {'d_model': 24, 'num_heads': 4, 'num_layers': 1, 'dff': 96, 'dropout': 0.4, 'epochs': 120, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 3032.6631
    MAE: 43.0976
    RMSE: 55.0696
    R²: 0.7176
    MAPE: 4.4796
    Direction_Accuracy: 49.2063
  transformer:
    MSE: 21683.6836
    MAE: 129.1157
    RMSE: 147.2538
    R²: -1.0194
    MAPE: 14.1143
    Direction_Accuracy: 41.7989
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 6: 组合优化-宽网络+低dropout
--------------------------------------------------
调优时间: 2025-10-15 00:07:54
配置参数:
  LSTM配置: {'units': [64, 32], 'dropout': 0.2, 'epochs': 150, 'batch_size': 4}
  Transformer配置: {'d_model': 32, 'num_heads': 2, 'num_layers': 1, 'dff': 128, 'dropout': 0.5, 'epochs': 120, 'batch_size': 4}
模型性能:
  lstm:
    MSE: 1817.3030
    MAE: 32.3229
    RMSE: 42.6298
    R²: 0.8308
    MAPE: 3.3549
    Direction_Accuracy: 48.6772
  transformer:
    MSE: 28700.1367
    MAE: 154.9918
    RMSE: 169.4111
    R²: -1.6729
    MAPE: 16.7652
    Direction_Accuracy: 46.5608
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 7: 组合优化-极小batch_size
--------------------------------------------------
调优时间: 2025-10-15 00:09:45
配置参数:
  LSTM配置: {'units': [128, 64], 'dropout': 0.25, 'epochs': 120, 'batch_size': 8}
  Transformer配置: {'d_model': 48, 'num_heads': 4, 'num_layers': 1, 'dff': 192, 'dropout': 0.4, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 1695.1294
    MAE: 30.2534
    RMSE: 41.1719
    R²: 0.8421
    MAPE: 3.1478
    Direction_Accuracy: 41.2698
  transformer:
    MSE: 8360.4395
    MAE: 82.9724
    RMSE: 91.4354
    R²: 0.2214
    MAPE: 9.1331
    Direction_Accuracy: 58.7302
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 8: 组合优化-大网络+高正则
--------------------------------------------------
调优时间: 2025-10-15 00:11:30
配置参数:
  LSTM配置: {'units': [80, 40], 'dropout': 0.18, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 28, 'num_heads': 4, 'num_layers': 1, 'dff': 112, 'dropout': 0.45, 'epochs': 110, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 1988.0900
    MAE: 33.9763
    RMSE: 44.5880
    R²: 0.8148
    MAPE: 3.5257
    Direction_Accuracy: 48.1481
  transformer:
    MSE: 8679.4014
    MAE: 82.0808
    RMSE: 93.1633
    R²: 0.1917
    MAPE: 8.8811
    Direction_Accuracy: 40.2116
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 9: 精细调优-微调组1
--------------------------------------------------
调优时间: 2025-10-15 00:12:58
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 20, 'num_heads': 2, 'num_layers': 1, 'dff': 80, 'dropout': 0.55, 'epochs': 130, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 1176.8821
    MAE: 25.1702
    RMSE: 34.3057
    R²: 0.8904
    MAPE: 2.6176
    Direction_Accuracy: 45.5026
  transformer:
    MSE: 144405.5469
    MAE: 345.0930
    RMSE: 380.0073
    R²: -12.4486
    MAPE: 36.7575
    Direction_Accuracy: 40.2116
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 10: 精细调优-微调组2
--------------------------------------------------

============================================================
第四轮调优最终结果
============================================================
最佳LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  R²: 0.8904
  RMSE: 34.3057
  MAE: 25.1702
  MAPE: 2.6176%

最佳Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
  R²: 0.7874
  RMSE: 47.7794
  MAE: 35.2319
  MAPE: 3.5694%

关键发现:
- LSTM性能恢复情况：成功恢复(R²=0.8904)
- Transformer过拟合解决：已解决(R²=0.7874)
- 最佳策略：batch_size=4-8 + epochs=120-150 + dropout微调

调优结束时间: 2025-10-15 00:12:58
============================================================