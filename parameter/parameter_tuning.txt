
============================================================
第五轮参数调优开始
============================================================
开始时间: 2025-10-15 07:24:59

问题诊断:
- LSTM从R²=0.8904崩溃至0.574，主配置文件可能被修改
- Transformer保持稳定(0.7874→0.7746)，简化策略有效

优化策略:
- LSTM: 强制恢复第四轮最佳+微调增强(12组配置)
- Transformer: 在稳定基础上微调以突破R²=0.80
- 策略: 围绕成功配置±10%微调，避免大幅跳跃

============================================================

调优时间: 2025-10-15 07:26:56
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 1927.6223
    MAE: 33.0192
    RMSE: 43.9047
    R²: 0.8205
    MAPE: 3.4313
    Direction_Accuracy: 45.5026
  transformer:
    MSE: 2490.5459
    MAE: 38.2329
    RMSE: 49.9054
    R²: 0.7681
    MAPE: 4.0736
    Direction_Accuracy: 45.5026
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 1: 第四轮最佳配置基线
--------------------------------------------------
调优时间: 2025-10-15 07:28:34
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 154, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 2527.6372
    MAE: 40.4879
    RMSE: 50.2756
    R²: 0.7646
    MAPE: 4.2223
    Direction_Accuracy: 50.2646
  transformer:
    MSE: 10266.4365
    MAE: 79.2073
    RMSE: 101.3234
    R²: 0.0439
    MAPE: 8.2684
    Direction_Accuracy: 40.2116
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 2: LSTM延长训练+10%
--------------------------------------------------
调优时间: 2025-10-15 07:30:18
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.14, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 2265.5713
    MAE: 35.6396
    RMSE: 47.5980
    R²: 0.7890
    MAPE: 3.6842
    Direction_Accuracy: 50.2646
  transformer:
    MSE: 32141.3926
    MAE: 145.0980
    RMSE: 179.2802
    R²: -1.9933
    MAPE: 15.3502
    Direction_Accuracy: 41.2698
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 3: LSTM降低dropout-10%
--------------------------------------------------
调优时间: 2025-10-15 07:31:57
配置参数:
  LSTM配置: {'units': [80, 40], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 1968.9014
    MAE: 34.5901
    RMSE: 44.3723
    R²: 0.8166
    MAPE: 3.6002
    Direction_Accuracy: 50.2646
  transformer:
    MSE: 42490.9570
    MAE: 194.2552
    RMSE: 206.1333
    R²: -2.9572
    MAPE: 21.4085
    Direction_Accuracy: 34.9206
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 4: LSTM增加神经元+10%
--------------------------------------------------
调优时间: 2025-10-15 07:33:49
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 20, 'num_heads': 2, 'num_layers': 2, 'dff': 80, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 2963.0425
    MAE: 43.6121
    RMSE: 54.4338
    R²: 0.7241
    MAPE: 4.5467
    Direction_Accuracy: 49.7354
  transformer:
    MSE: 2886.1580
    MAE: 43.8931
    RMSE: 53.7230
    R²: 0.7312
    MAPE: 4.7294
    Direction_Accuracy: 44.9735
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 5: Transformer扩容d_model+25%
--------------------------------------------------
调优时间: 2025-10-15 07:35:41
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.55, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 1522.6317
    MAE: 29.4506
    RMSE: 39.0209
    R²: 0.8582
    MAPE: 3.0866
    Direction_Accuracy: 45.5026
  transformer:
    MSE: 13306.3740
    MAE: 98.4601
    RMSE: 115.3533
    R²: -0.2392
    MAPE: 10.5766
    Direction_Accuracy: 53.9683
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 6: Transformer降低dropout-0.05
--------------------------------------------------
调优时间: 2025-10-15 07:37:04
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 160, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 120, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 1337.6379
    MAE: 27.7406
    RMSE: 36.5737
    R²: 0.8754
    MAPE: 2.9110
    Direction_Accuracy: 44.9735
  transformer:
    MSE: 15528.6709
    MAE: 115.1823
    RMSE: 124.6141
    R²: -0.4462
    MAPE: 12.2689
    Direction_Accuracy: 53.4392
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 7: 联合增加训练轮数
--------------------------------------------------
调优时间: 2025-10-15 07:39:17
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 4}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 4}
模型性能:
  lstm:
    MSE: 1826.8807
    MAE: 34.0609
    RMSE: 42.7420
    R²: 0.8299
    MAPE: 3.5408
    Direction_Accuracy: 48.6772
  transformer:
    MSE: 73539.7891
    MAE: 242.4643
    RMSE: 271.1822
    R²: -5.8488
    MAPE: 25.8328
    Direction_Accuracy: 38.6243
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 8: 联合极小batch_size=4
--------------------------------------------------
调优时间: 2025-10-15 07:40:29
配置参数:
  LSTM配置: {'units': [72, 48, 24], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 3683.4204
    MAE: 48.5609
    RMSE: 60.6912
    R²: 0.6570
    MAPE: 5.0827
    Direction_Accuracy: 42.3280
  transformer:
    MSE: 127075.4609
    MAE: 319.8527
    RMSE: 356.4764
    R²: -10.8346
    MAPE: 34.9226
    Direction_Accuracy: 38.0952
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 9: LSTM增加深度三层
--------------------------------------------------
调优时间: 2025-10-15 07:42:09
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 3, 'dff': 64, 'dropout': 0.65, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 1848.4280
    MAE: 32.7775
    RMSE: 42.9933
    R²: 0.8279
    MAPE: 3.4115
    Direction_Accuracy: 45.5026
  transformer:
    MSE: 103457.6016
    MAE: 288.1610
    RMSE: 321.6483
    R²: -8.6351
    MAPE: 31.0549
    Direction_Accuracy: 37.0370
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 10: Transformer增加深度三层
--------------------------------------------------
调优时间: 2025-10-15 07:43:02
配置参数:
  LSTM配置: {'units': [80, 40], 'dropout': 0.14, 'epochs': 160, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 4564.3076
    MAE: 52.8592
    RMSE: 67.5597
    R²: 0.5749
    MAPE: 5.5376
    Direction_Accuracy: 42.8571
  transformer:
    MSE: 172060.2031
    MAE: 338.6302
    RMSE: 414.8014
    R²: -15.0241
    MAPE: 34.9307
    Direction_Accuracy: 37.0370
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 11: LSTM极致优化-多维增强
--------------------------------------------------
调优时间: 2025-10-15 07:44:52
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 24, 'num_heads': 2, 'num_layers': 2, 'dff': 96, 'dropout': 0.55, 'epochs': 120, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 3229.4731
    MAE: 46.4663
    RMSE: 56.8285
    R²: 0.6992
    MAPE: 4.8342
    Direction_Accuracy: 48.6772
  transformer:
    MSE: 119849.9375
    MAE: 332.6376
    RMSE: 346.1935
    R²: -10.1617
    MAPE: 36.0188
    Direction_Accuracy: 39.1534
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 12: Transformer极致优化-突破R²0.80
--------------------------------------------------

============================================================
第五轮调优最终结果
============================================================
最佳LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 160, 'batch_size': 8}
  R²: 0.8754
  RMSE: 36.5737
  MAE: 27.7406
  MAPE: 2.9110%

最佳Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
  R²: 0.7681
  RMSE: 49.9054
  MAE: 38.2329
  MAPE: 4.0736%

关键发现:
- LSTM性能恢复情况：进展中(R²=0.8754)
- Transformer突破情况：稳定状态(R²=0.7681)
- 最佳策略：围绕第四轮成功配置±10%微调
- 性能评估：部分达标

调优结束时间: 2025-10-15 07:44:52
============================================================