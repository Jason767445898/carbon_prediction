# 文件结构适配说明

## 📋 修改日期
2025-10-17

## 🎯 修改目的
将代码适配到新的文件结构，统一输出目录管理

## 📁 新的文件结构

```
/Users/Jason/Desktop/code/AI/
├── carbon_price_prediction.py     # 主程序
├── data.dta                        # 数据文件
├── parameter/                      # 参数调优目录
│   └── parameter_tuning.py        # 参数调优脚本
└── outputs/                        # 统一输出目录
    ├── logs/                       # 日志文件（原 carbon_prediction_log_txt/）
    ├── reports/                    # 报告文件（原 carbon_prediction_results_excel/）
    └── visualizations/             # 可视化图表（原 carbon_prediction_results_pic/）
```

## ✅ 完成的修改

### 1. carbon_price_prediction.py

#### 修改点1：输出目录配置
```python
# 修改前
OUTPUT_DIRS = {
    'txt': 'carbon_prediction_log_txt',
    'excel': 'carbon_prediction_results_excel', 
    'pic': 'carbon_prediction_results_pic'
}

# 修改后
OUTPUT_DIRS = {
    'txt': 'outputs/logs',
    'excel': 'outputs/reports', 
    'pic': 'outputs/visualizations'
}
```

#### 修改点2：运行日志信息
在 `_generate_runtime_log()` 方法中：
- 添加了运行ID显示
- 更新了文件路径说明为新的目录结构

#### 修改点3：主函数输出信息
在 `main()` 函数中：
- 更新了成功执行后的文件路径显示
- 统一显示为 `outputs/` 目录下的文件

### 2. parameter/parameter_tuning.py

#### 修改点1：日志文件路径
```python
# 修改前
log_file = 'parameter_tuning.txt'

# 修改后
log_file = '../outputs/logs/parameter_tuning.txt'
```

#### 修改点2：数据文件路径
```python
# 修改前
system.load_data('data.dta')

# 修改后
system.load_data('../data.dta')  # 相对于parameter/目录的路径
```

#### 修改点3：日志目录创建
在 `main()` 函数中添加：
```python
# 确保输出目录存在
log_dir = '../outputs/logs'
os.makedirs(log_dir, exist_ok=True)
```

## 🔄 路径说明

### 主程序（carbon_price_prediction.py）
- **工作目录**: `/Users/Jason/Desktop/code/AI/`
- **数据文件**: `data.dta`（相对路径）
- **输出目录**: `outputs/logs/`, `outputs/reports/`, `outputs/visualizations/`

### 参数调优脚本（parameter/parameter_tuning.py）
- **工作目录**: `/Users/Jason/Desktop/code/AI/parameter/`
- **数据文件**: `../data.dta`（向上一级目录）
- **输出日志**: `../outputs/logs/parameter_tuning.txt`

## 📊 输出文件映射

| 原目录 | 新目录 | 说明 |
|--------|--------|------|
| `carbon_prediction_log_txt/` | `outputs/logs/` | 运行日志和参数调优日志 |
| `carbon_prediction_results_excel/` | `outputs/reports/` | Excel分析报告 |
| `carbon_prediction_results_pic/` | `outputs/visualizations/` | 可视化图表 |

## 💡 使用说明

### 运行主程序
```bash
cd /Users/Jason/Desktop/code/AI
python3 carbon_price_prediction.py
```

### 运行参数调优
```bash
cd /Users/Jason/Desktop/code/AI/parameter
python3 parameter_tuning.py

# 或使用防休眠模式
caffeinate -i python3 parameter_tuning.py
```

## 🎉 优势

1. **统一管理**: 所有输出文件集中在 `outputs/` 目录
2. **结构清晰**: 按类型（日志、报告、图表）分类存储
3. **易于维护**: 符合标准项目结构规范
4. **版本控制**: 便于 git 管理（可在 .gitignore 中统一配置）

## ⚠️ 注意事项

1. 首次运行前，`outputs/` 目录会自动创建
2. 旧的输出目录中的文件不会自动迁移，请手动迁移重要文件
3. 所有脚本现在都会自动创建必要的输出目录

## 🔧 向后兼容性

如果需要恢复旧的目录结构，只需修改 `carbon_price_prediction.py` 中的 `OUTPUT_DIRS` 配置即可。

---

**修改完成日期**: 2025-10-17  
**测试状态**: ✅ 代码语法检查通过
