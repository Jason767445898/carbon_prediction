

============================================================
第五轮参数调优开始
============================================================
开始时间: 2025-10-15 14:15:46

问题诊断:
- LSTM从R²=0.8904崩溃至0.574，主配置文件可能被修改
- Transformer保持稳定(0.7874→0.7746)，简化策略有效

优化策略:
- LSTM: 强制恢复第四轮最佳+微调增强(12组配置)
- Transformer: 在稳定基础上微调以突破R²=0.80
- 策略: 围绕成功配置±10%微调，避免大幅跳跃

============================================================

调优时间: 2025-10-15 14:17:33
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 2547.2913
    MAE: 39.9272
    RMSE: 50.4707
    R²: 0.7628
    MAPE: 4.1421
    Direction_Accuracy: 48.6772
  transformer:
    MSE: 71026.5078
    MAE: 254.2565
    RMSE: 266.5080
    R²: -5.6147
    MAPE: 27.7748
    Direction_Accuracy: 40.7407
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 1: 第四轮最佳配置基线
--------------------------------------------------
调优时间: 2025-10-15 14:18:26
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 154, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 4862.5771
    MAE: 54.4495
    RMSE: 69.7322
    R²: 0.5471
    MAPE: 5.7245
    Direction_Accuracy: 41.2698
  transformer:
    MSE: 125216.3125
    MAE: 342.2333
    RMSE: 353.8592
    R²: -10.6615
    MAPE: 37.3551
    Direction_Accuracy: 42.3280
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 2: LSTM延长训练+10%
--------------------------------------------------
调优时间: 2025-10-15 14:19:33
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.14, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 9558.3027
    MAE: 84.5507
    RMSE: 97.7666
    R²: 0.1098
    MAPE: 8.8988
    Direction_Accuracy: 41.7989
  transformer:
    MSE: 5220.8242
    MAE: 53.7186
    RMSE: 72.2553
    R²: 0.5138
    MAPE: 5.6475
    Direction_Accuracy: 46.5608
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 3: LSTM降低dropout-10%
--------------------------------------------------
调优时间: 2025-10-15 14:21:26
配置参数:
  LSTM配置: {'units': [80, 40], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 2222.6519
    MAE: 35.3212
    RMSE: 47.1450
    R²: 0.7930
    MAPE: 3.6376
    Direction_Accuracy: 50.2646
  transformer:
    MSE: 24107.7734
    MAE: 133.8266
    RMSE: 155.2668
    R²: -1.2452
    MAPE: 13.6772
    Direction_Accuracy: 30.1587
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 4: LSTM增加神经元+10%
--------------------------------------------------
调优时间: 2025-10-15 14:22:36
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 20, 'num_heads': 2, 'num_layers': 2, 'dff': 80, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 5746.1870
    MAE: 62.9271
    RMSE: 75.8036
    R²: 0.4649
    MAPE: 6.5944
    Direction_Accuracy: 41.7989
  transformer:
    MSE: 101389.8594
    MAE: 296.6522
    RMSE: 318.4178
    R²: -8.4425
    MAPE: 31.7082
    Direction_Accuracy: 39.1534
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 5: Transformer扩容d_model+25%
--------------------------------------------------
调优时间: 2025-10-15 14:24:10
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.55, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 1429.1464
    MAE: 27.8126
    RMSE: 37.8041
    R²: 0.8669
    MAPE: 2.8858
    Direction_Accuracy: 42.8571
  transformer:
    MSE: 6008.2134
    MAE: 58.5107
    RMSE: 77.5127
    R²: 0.4405
    MAPE: 6.5302
    Direction_Accuracy: 29.6296
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 6: Transformer降低dropout-0.05
--------------------------------------------------
调优时间: 2025-10-15 14:25:21
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 160, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 120, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 3594.9927
    MAE: 48.4693
    RMSE: 59.9583
    R²: 0.6652
    MAPE: 5.0874
    Direction_Accuracy: 45.5026
  transformer:
    MSE: 93351.1250
    MAE: 253.8537
    RMSE: 305.5341
    R²: -7.6938
    MAPE: 26.4635
    Direction_Accuracy: 42.3280
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 7: 联合增加训练轮数
--------------------------------------------------
调优时间: 2025-10-15 14:26:34
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 4}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 4}
模型性能:
  lstm:
    MSE: 2854.8018
    MAE: 41.6953
    RMSE: 53.4303
    R²: 0.7341
    MAPE: 4.3572
    Direction_Accuracy: 39.6825
  transformer:
    MSE: 132182.4062
    MAE: 348.0173
    RMSE: 363.5690
    R²: -11.3102
    MAPE: 38.5305
    Direction_Accuracy: 35.4497
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 8: 联合极小batch_size=4
--------------------------------------------------
调优时间: 2025-10-15 14:27:35
配置参数:
  LSTM配置: {'units': [72, 48, 24], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 5176.5981
    MAE: 56.2409
    RMSE: 71.9486
    R²: 0.5179
    MAPE: 5.8374
    Direction_Accuracy: 42.3280
  transformer:
    MSE: 288051.9375
    MAE: 527.8021
    RMSE: 536.7047
    R²: -25.8264
    MAPE: 57.5340
    Direction_Accuracy: 33.3333
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 9: LSTM增加深度三层
--------------------------------------------------
调优时间: 2025-10-15 14:29:39
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 3, 'dff': 64, 'dropout': 0.65, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 2121.0178
    MAE: 36.0680
    RMSE: 46.0545
    R²: 0.8025
    MAPE: 3.7529
    Direction_Accuracy: 49.2063
  transformer:
    MSE: 42429.0273
    MAE: 194.4100
    RMSE: 205.9831
    R²: -2.9514
    MAPE: 21.1118
    Direction_Accuracy: 38.6243
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 10: Transformer增加深度三层
--------------------------------------------------
调优时间: 2025-10-15 14:30:47
配置参数:
  LSTM配置: {'units': [80, 40], 'dropout': 0.14, 'epochs': 160, 'batch_size': 8}
  Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 5085.1460
    MAE: 58.8746
    RMSE: 71.3102
    R²: 0.5264
    MAPE: 6.1632
    Direction_Accuracy: 44.4444
  transformer:
    MSE: 7652.1743
    MAE: 72.3985
    RMSE: 87.4767
    R²: 0.2873
    MAPE: 7.9877
    Direction_Accuracy: 50.2646
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 11: LSTM极致优化-多维增强
--------------------------------------------------
调优时间: 2025-10-15 14:31:42
配置参数:
  LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  Transformer配置: {'d_model': 24, 'num_heads': 2, 'num_layers': 2, 'dff': 96, 'dropout': 0.55, 'epochs': 120, 'batch_size': 8}
模型性能:
  lstm:
    MSE: 4555.4858
    MAE: 56.1560
    RMSE: 67.4943
    R²: 0.5757
    MAPE: 5.8606
    Direction_Accuracy: 41.7989
  transformer:
    MSE: 214460.8281
    MAE: 390.6684
    RMSE: 463.0992
    R²: -18.9729
    MAPE: 41.0383
    Direction_Accuracy: 31.2169
  RandomForest:
    MSE: 2064.4819
    MAE: 33.5191
    RMSE: 45.4366
    R²: 0.9290
    MAPE: 3.1751
    Direction_Accuracy: 60.2410
  GradientBoosting:
    MSE: 3657.0491
    MAE: 43.3011
    RMSE: 60.4735
    R²: 0.8742
    MAPE: 4.0426
    Direction_Accuracy: 55.8233
  XGBoost:
    MSE: 9876.8926
    MAE: 58.9860
    RMSE: 99.3826
    R²: 0.6603
    MAPE: 4.9909
    Direction_Accuracy: 51.8072
备注: 联合配置测试 12: Transformer极致优化-突破R²0.80
--------------------------------------------------

============================================================
第五轮调优最终结果
============================================================
最佳LSTM配置: {'units': [72, 36], 'dropout': 0.16, 'epochs': 140, 'batch_size': 8}
  R²: 0.8669
  RMSE: 37.8041
  MAE: 27.8126
  MAPE: 2.8858%

最佳Transformer配置: {'d_model': 16, 'num_heads': 2, 'num_layers': 2, 'dff': 64, 'dropout': 0.6, 'epochs': 100, 'batch_size': 8}
  R²: 0.5138
  RMSE: 72.2553
  MAE: 53.7186
  MAPE: 5.6475%

关键发现:
- LSTM性能恢复情况：进展中(R²=0.8669)
- Transformer突破情况：稳定状态(R²=0.5138)
- 最佳策略：围绕第四轮成功配置±10%微调
- 性能评估：部分达标

调优结束时间: 2025-10-15 14:31:42
============================================================